import * as cdk from 'aws-cdk-lib';
import * as aws_dynamodb from 'aws-cdk-lib/aws-dynamodb';
import { AttributeType, BillingMode } from 'aws-cdk-lib/aws-dynamodb';
export const DynamoDBTableProps = {
    RoutesDbTable: {
        Name: 'RoutesDB',
        PartitionKeyName: 'pairTradeTypeChainId',
        SortKeyName: 'routeId',
    },
    RoutesDbCachingRequestFlagTable: {
        Name: 'RoutesDbCacheReqFlagDB',
        PartitionKeyName: 'pairTradeTypeChainId',
        SortKeyName: 'amount',
    },
    CacheRouteDynamoDbTable: {
        Name: 'RouteCachingDB',
        PartitionKeyName: 'pairTradeTypeChainId',
        SortKeyName: 'protocolsBucketBlockNumber',
    },
    CachingRequestFlagDynamoDbTable: {
        Name: 'CacheReqFlagDB',
        PartitionKeyName: 'pairTradeTypeChainId',
        SortKeyName: 'protocolsBucketBlockNumber',
    },
    V3PoolsDynamoDbTable: {
        Name: 'V3PoolsCachingDB',
        PartitionKeyName: 'poolAddress',
        SortKeyName: 'blockNumber',
    },
    V2PairsDynamoCache: {
        Name: 'V2PairsCachingDB',
        PartitionKeyName: 'cacheKey',
        SortKeyName: 'block',
    },
    TokenPropertiesCachingDbTable: {
        Name: 'TokenPropertiesCachingDb',
        PartitionKeyName: 'chainIdTokenAddress',
    },
    TTLAttributeName: 'ttl',
};
export class RoutingDatabaseStack extends cdk.NestedStack {
    constructor(scope, name, props) {
        super(scope, name, props);
        // Creates a DynamoDB Table for storing the routes
        this.routesDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.RoutesDbTable.Name, {
            tableName: DynamoDBTableProps.RoutesDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.RoutesDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.RoutesDbTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the buckets that are flagging as already cached in the RoutesDb
        this.routesDbCachingRequestFlagDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.RoutesDbCachingRequestFlagTable.Name, {
            tableName: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            sortKey: { name: DynamoDBTableProps.RoutesDbCachingRequestFlagTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the cached routes
        this.cachedRoutesDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.CacheRouteDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.CacheRouteDynamoDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.CacheRouteDynamoDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.CacheRouteDynamoDbTable.SortKeyName, type: AttributeType.STRING },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the buckets that are flagging as already cached in the CachedRoutesDb
        this.cachingRequestFlagDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.CachingRequestFlagDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            sortKey: { name: DynamoDBTableProps.CachingRequestFlagDynamoDbTable.SortKeyName, type: AttributeType.STRING },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the cached v3 pools
        this.cachedV3PoolsDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.V3PoolsDynamoDbTable.Name, {
            tableName: DynamoDBTableProps.V3PoolsDynamoDbTable.Name,
            partitionKey: { name: DynamoDBTableProps.V3PoolsDynamoDbTable.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.V3PoolsDynamoDbTable.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a DynamoDB Table for storing the cached v2 pairs
        this.cachedV2PairsDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.V2PairsDynamoCache.Name, {
            tableName: DynamoDBTableProps.V2PairsDynamoCache.Name,
            partitionKey: { name: DynamoDBTableProps.V2PairsDynamoCache.PartitionKeyName, type: AttributeType.STRING },
            sortKey: { name: DynamoDBTableProps.V2PairsDynamoCache.SortKeyName, type: AttributeType.NUMBER },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
        // Creates a TokenValidationResult Table for storing the FOT/SFT tokens
        this.tokenPropertiesCachingDynamoDb = new aws_dynamodb.Table(this, DynamoDBTableProps.TokenPropertiesCachingDbTable.Name, {
            tableName: DynamoDBTableProps.TokenPropertiesCachingDbTable.Name,
            partitionKey: {
                name: DynamoDBTableProps.TokenPropertiesCachingDbTable.PartitionKeyName,
                type: AttributeType.STRING,
            },
            billingMode: BillingMode.PAY_PER_REQUEST,
            timeToLiveAttribute: DynamoDBTableProps.TTLAttributeName,
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy1kYXRhYmFzZS1zdGFjay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2Jpbi9zdGFja3Mvcm91dGluZy1kYXRhYmFzZS1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssR0FBRyxNQUFNLGFBQWEsQ0FBQTtBQUNsQyxPQUFPLEtBQUssWUFBWSxNQUFNLDBCQUEwQixDQUFBO0FBQ3hELE9BQU8sRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLE1BQU0sMEJBQTBCLENBQUE7QUFLckUsTUFBTSxDQUFDLE1BQU0sa0JBQWtCLEdBQUc7SUFDaEMsYUFBYSxFQUFFO1FBQ2IsSUFBSSxFQUFFLFVBQVU7UUFDaEIsZ0JBQWdCLEVBQUUsc0JBQXNCO1FBQ3hDLFdBQVcsRUFBRSxTQUFTO0tBQ3ZCO0lBQ0QsK0JBQStCLEVBQUU7UUFDL0IsSUFBSSxFQUFFLHdCQUF3QjtRQUM5QixnQkFBZ0IsRUFBRSxzQkFBc0I7UUFDeEMsV0FBVyxFQUFFLFFBQVE7S0FDdEI7SUFDRCx1QkFBdUIsRUFBRTtRQUN2QixJQUFJLEVBQUUsZ0JBQWdCO1FBQ3RCLGdCQUFnQixFQUFFLHNCQUFzQjtRQUN4QyxXQUFXLEVBQUUsNEJBQTRCO0tBQzFDO0lBQ0QsK0JBQStCLEVBQUU7UUFDL0IsSUFBSSxFQUFFLGdCQUFnQjtRQUN0QixnQkFBZ0IsRUFBRSxzQkFBc0I7UUFDeEMsV0FBVyxFQUFFLDRCQUE0QjtLQUMxQztJQUNELG9CQUFvQixFQUFFO1FBQ3BCLElBQUksRUFBRSxrQkFBa0I7UUFDeEIsZ0JBQWdCLEVBQUUsYUFBYTtRQUMvQixXQUFXLEVBQUUsYUFBYTtLQUMzQjtJQUNELGtCQUFrQixFQUFFO1FBQ2xCLElBQUksRUFBRSxrQkFBa0I7UUFDeEIsZ0JBQWdCLEVBQUUsVUFBVTtRQUM1QixXQUFXLEVBQUUsT0FBTztLQUNyQjtJQUNELDZCQUE2QixFQUFFO1FBQzdCLElBQUksRUFBRSwwQkFBMEI7UUFDaEMs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V0FBVyxDQUFDLGVBQWU7WUFDeEMsbUJBQW1CLEVBQUUsa0JBQWtCLENBQUMsZ0JBQWdCO1NBQ3pELENBQUMsQ0FBQTtRQUVGLHVFQUF1RTtRQUN2RSxJQUFJLENBQUMsOEJBQThCLEdBQUcsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUMxRCxJQUFJLEVBQ0osa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsSUFBSSxFQUNyRDtZQUNFLFNBQVMsRUFBRSxrQkFBa0IsQ0FBQyw2QkFBNkIsQ0FBQyxJQUFJO1lBQ2hFLFlBQVksRUFBRTtnQkFDWixJQUFJLEVBQUUsa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsZ0JBQWdCO2dCQUN2RSxJQUFJLEVBQUUsYUFBYSxDQUFDLE1BQU07YUFDM0I7WUFDRCxXQUFXLEVBQUUsV0FBVyxDQUFDLGVBQWU7WUFDeEMsbUJBQW1CLEVBQUUsa0JBQWtCLENBQUMsZ0JBQWdCO1NBQ3pELENBQ0YsQ0FBQTtJQUNILENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYidcbmltcG9ydCAqIGFzIGF3c19keW5hbW9kYiBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGInXG5pbXBvcnQgeyBBdHRyaWJ1dGVUeXBlLCBCaWxsaW5nTW9kZSB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1keW5hbW9kYidcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgUm91dGluZ0RhdGFiYXNlU3RhY2tQcm9wcyBleHRlbmRzIGNkay5OZXN0ZWRTdGFja1Byb3BzIHt9XG5cbmV4cG9ydCBjb25zdCBEeW5hbW9EQlRhYmxlUHJvcHMgPSB7XG4gIFJvdXRlc0RiVGFibGU6IHtcbiAgICBOYW1lOiAnUm91dGVzREInLFxuICAgIFBhcnRpdGlvbktleU5hbWU6ICdwYWlyVHJhZGVUeXBlQ2hhaW5JZCcsXG4gICAgU29ydEtleU5hbWU6ICdyb3V0ZUlkJyxcbiAgfSxcbiAgUm91dGVzRGJDYWNoaW5nUmVxdWVzdEZsYWdUYWJsZToge1xuICAgIE5hbWU6ICdSb3V0ZXNEYkNhY2hlUmVxRmxhZ0RCJyxcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiAncGFpclRyYWRlVHlwZUNoYWluSWQnLFxuICAgIFNvcnRLZXlOYW1lOiAnYW1vdW50JyxcbiAgfSxcbiAgQ2FjaGVSb3V0ZUR5bmFtb0RiVGFibGU6IHtcbiAgICBOYW1lOiAnUm91dGVDYWNoaW5nREInLFxuICAgIFBhcnRpdGlvbktleU5hbWU6ICdwYWlyVHJhZGVUeXBlQ2hhaW5JZCcsXG4gICAgU29ydEtleU5hbWU6ICdwcm90b2NvbHNCdWNrZXRCbG9ja051bWJlcicsXG4gIH0sXG4gIENhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiVGFibGU6IHtcbiAgICBOYW1lOiAnQ2FjaGVSZXFGbGFnREInLFxuICAgIFBhcnRpdGlvbktleU5hbWU6ICdwYWlyVHJhZGVUeXBlQ2hhaW5JZCcsXG4gICAgU29ydEtleU5hbWU6ICdwcm90b2NvbHNCdWNrZXRCbG9ja051bWJlcicsXG4gIH0sXG4gIFYzUG9vbHNEeW5hbW9EYlRhYmxlOiB7XG4gICAgTmFtZTogJ1YzUG9vbHNDYWNoaW5nREInLFxuICAgIFBhcnRpdGlvbktleU5hbWU6ICdwb29sQWRkcmVzcycsXG4gICAgU29ydEtleU5hbWU6ICdibG9ja051bWJlcicsXG4gIH0sXG4gIFYyUGFpcnNEeW5hbW9DYWNoZToge1xuICAgIE5hbWU6ICdWMlBhaXJzQ2FjaGluZ0RCJyxcbiAgICBQYXJ0aXRpb25LZXlOYW1lOiAnY2FjaGVLZXknLFxuICAgIFNvcnRLZXlOYW1lOiAnYmxvY2snLFxuICB9LFxuICBUb2tlblByb3BlcnRpZXNDYWNoaW5nRGJUYWJsZToge1xuICAgIE5hbWU6ICdUb2tlblByb3BlcnRpZXNDYWNoaW5nRGInLFxuICAgIFBhcnRpdGlvbktleU5hbWU6ICdjaGFpbklkVG9rZW5BZGRyZXNzJyxcbiAgfSxcbiAgVFRMQXR0cmlidXRlTmFtZTogJ3R0bCcsXG59XG5cbmV4cG9ydCBjbGFzcyBSb3V0aW5nRGF0YWJhc2VTdGFjayBleHRlbmRzIGNkay5OZXN0ZWRTdGFjayB7XG4gIHB1YmxpYyByZWFkb25seSByb3V0ZXNEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlXG4gIHB1YmxpYyByZWFkb25seSByb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiOiBhd3NfZHluYW1vZGIuVGFibGVcblxuICAvLyBXQVJOSU5HOiBldmVuIHRob3VnaCBjYWNoZWRSb3V0ZXNEeW5hbW9EYiBhbmQgY2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGIgYXJlIG5vdCB1c2VkIGluIHByb2RcbiAgLy8gICAgICAgICAgd2Ugc3RpbGwgaGF2ZSB0byBrZWVwIHRoZXJlIGhlcmUuIFJlbW92aW5nIHRoZW0gd2lsbCBjYXVzZSByb3V0ZXMgREIgdG8gc3RvcCByZWNlaXZpbmdcbiAgLy8gICAgICAgICAgY2FjaGVkIHJvdXRlcy4gV2UgZG9uJ3Qga25vdyB3aHksIGJ1dCBsZXQncyBub3QgZGVsZXRlIGNhY2hlZFJvdXRlc0R5bmFtb0RiIG9yIGNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiXG4gIHB1YmxpYyByZWFkb25seSBjYWNoZWRSb3V0ZXNEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlXG4gIHB1YmxpYyByZWFkb25seSBjYWNoaW5nUmVxdWVzdEZsYWdEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlXG5cbiAgcHVibGljIHJlYWRvbmx5IGNhY2hlZFYzUG9vbHNEeW5hbW9EYjogYXdzX2R5bmFtb2RiLlRhYmxlXG4gIHB1YmxpYyByZWFkb25seSBjYWNoZWRWMlBhaXJzRHluYW1vRGI6IGF3c19keW5hbW9kYi5UYWJsZVxuICBwdWJsaWMgcmVhZG9ubHkgdG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0R5bmFtb0RiOiBhd3NfZHluYW1vZGIuVGFibGVcblxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBuYW1lOiBzdHJpbmcsIHByb3BzOiBSb3V0aW5nRGF0YWJhc2VTdGFja1Byb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIG5hbWUsIHByb3BzKVxuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSByb3V0ZXNcbiAgICB0aGlzLnJvdXRlc0R5bmFtb0RiID0gbmV3IGF3c19keW5hbW9kYi5UYWJsZSh0aGlzLCBEeW5hbW9EQlRhYmxlUHJvcHMuUm91dGVzRGJUYWJsZS5OYW1lLCB7XG4gICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5Sb3V0ZXNEYlRhYmxlLk5hbWUsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIHNvcnRLZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiVGFibGUuU29ydEtleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgfSlcblxuICAgIC8vIENyZWF0ZXMgYSBEeW5hbW9EQiBUYWJsZSBmb3Igc3RvcmluZyB0aGUgYnVja2V0cyB0aGF0IGFyZSBmbGFnZ2luZyBhcyBhbHJlYWR5IGNhY2hlZCBpbiB0aGUgUm91dGVzRGJcbiAgICB0aGlzLnJvdXRlc0RiQ2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGIgPSBuZXcgYXdzX2R5bmFtb2RiLlRhYmxlKFxuICAgICAgdGhpcyxcbiAgICAgIER5bmFtb0RCVGFibGVQcm9wcy5Sb3V0ZXNEYkNhY2hpbmdSZXF1ZXN0RmxhZ1RhYmxlLk5hbWUsXG4gICAgICB7XG4gICAgICAgIHRhYmxlTmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiQ2FjaGluZ1JlcXVlc3RGbGFnVGFibGUuTmFtZSxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICAgICAgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlJvdXRlc0RiQ2FjaGluZ1JlcXVlc3RGbGFnVGFibGUuUGFydGl0aW9uS2V5TmFtZSxcbiAgICAgICAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgICAgICAgfSxcbiAgICAgICAgc29ydEtleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuUm91dGVzRGJDYWNoaW5nUmVxdWVzdEZsYWdUYWJsZS5Tb3J0S2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5OVU1CRVIgfSxcbiAgICAgICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgICB9XG4gICAgKVxuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSBjYWNoZWQgcm91dGVzXG4gICAgdGhpcy5jYWNoZWRSb3V0ZXNEeW5hbW9EYiA9IG5ldyBhd3NfZHluYW1vZGIuVGFibGUodGhpcywgRHluYW1vREJUYWJsZVByb3BzLkNhY2hlUm91dGVEeW5hbW9EYlRhYmxlLk5hbWUsIHtcbiAgICAgIHRhYmxlTmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hlUm91dGVEeW5hbW9EYlRhYmxlLk5hbWUsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hlUm91dGVEeW5hbW9EYlRhYmxlLlBhcnRpdGlvbktleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICBzb3J0S2V5OiB7IG5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5DYWNoZVJvdXRlRHluYW1vRGJUYWJsZS5Tb3J0S2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgICB0aW1lVG9MaXZlQXR0cmlidXRlOiBEeW5hbW9EQlRhYmxlUHJvcHMuVFRMQXR0cmlidXRlTmFtZSxcbiAgICB9KVxuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSBidWNrZXRzIHRoYXQgYXJlIGZsYWdnaW5nIGFzIGFscmVhZHkgY2FjaGVkIGluIHRoZSBDYWNoZWRSb3V0ZXNEYlxuICAgIHRoaXMuY2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGIgPSBuZXcgYXdzX2R5bmFtb2RiLlRhYmxlKFxuICAgICAgdGhpcyxcbiAgICAgIER5bmFtb0RCVGFibGVQcm9wcy5DYWNoaW5nUmVxdWVzdEZsYWdEeW5hbW9EYlRhYmxlLk5hbWUsXG4gICAgICB7XG4gICAgICAgIHRhYmxlTmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiVGFibGUuTmFtZSxcbiAgICAgICAgcGFydGl0aW9uS2V5OiB7XG4gICAgICAgICAgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLkNhY2hpbmdSZXF1ZXN0RmxhZ0R5bmFtb0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSxcbiAgICAgICAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgICAgICAgfSxcbiAgICAgICAgc29ydEtleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuQ2FjaGluZ1JlcXVlc3RGbGFnRHluYW1vRGJUYWJsZS5Tb3J0S2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgICB9XG4gICAgKVxuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSBjYWNoZWQgdjMgcG9vbHNcbiAgICB0aGlzLmNhY2hlZFYzUG9vbHNEeW5hbW9EYiA9IG5ldyBhd3NfZHluYW1vZGIuVGFibGUodGhpcywgRHluYW1vREJUYWJsZVByb3BzLlYzUG9vbHNEeW5hbW9EYlRhYmxlLk5hbWUsIHtcbiAgICAgIHRhYmxlTmFtZTogRHluYW1vREJUYWJsZVByb3BzLlYzUG9vbHNEeW5hbW9EYlRhYmxlLk5hbWUsXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogRHluYW1vREJUYWJsZVByb3BzLlYzUG9vbHNEeW5hbW9EYlRhYmxlLlBhcnRpdGlvbktleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICBzb3J0S2V5OiB7IG5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5WM1Bvb2xzRHluYW1vRGJUYWJsZS5Tb3J0S2V5TmFtZSwgdHlwZTogQXR0cmlidXRlVHlwZS5OVU1CRVIgfSxcbiAgICAgIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgICB0aW1lVG9MaXZlQXR0cmlidXRlOiBEeW5hbW9EQlRhYmxlUHJvcHMuVFRMQXR0cmlidXRlTmFtZSxcbiAgICB9KVxuXG4gICAgLy8gQ3JlYXRlcyBhIER5bmFtb0RCIFRhYmxlIGZvciBzdG9yaW5nIHRoZSBjYWNoZWQgdjIgcGFpcnNcbiAgICB0aGlzLmNhY2hlZFYyUGFpcnNEeW5hbW9EYiA9IG5ldyBhd3NfZHluYW1vZGIuVGFibGUodGhpcywgRHluYW1vREJUYWJsZVByb3BzLlYyUGFpcnNEeW5hbW9DYWNoZS5OYW1lLCB7XG4gICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5WMlBhaXJzRHluYW1vQ2FjaGUuTmFtZSxcbiAgICAgIHBhcnRpdGlvbktleTogeyBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuVjJQYWlyc0R5bmFtb0NhY2hlLlBhcnRpdGlvbktleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICBzb3J0S2V5OiB7IG5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5WMlBhaXJzRHluYW1vQ2FjaGUuU29ydEtleU5hbWUsIHR5cGU6IEF0dHJpYnV0ZVR5cGUuTlVNQkVSIH0sXG4gICAgICBiaWxsaW5nTW9kZTogQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgfSlcblxuICAgIC8vIENyZWF0ZXMgYSBUb2tlblZhbGlkYXRpb25SZXN1bHQgVGFibGUgZm9yIHN0b3JpbmcgdGhlIEZPVC9TRlQgdG9rZW5zXG4gICAgdGhpcy50b2tlblByb3BlcnRpZXNDYWNoaW5nRHluYW1vRGIgPSBuZXcgYXdzX2R5bmFtb2RiLlRhYmxlKFxuICAgICAgdGhpcyxcbiAgICAgIER5bmFtb0RCVGFibGVQcm9wcy5Ub2tlblByb3BlcnRpZXNDYWNoaW5nRGJUYWJsZS5OYW1lLFxuICAgICAge1xuICAgICAgICB0YWJsZU5hbWU6IER5bmFtb0RCVGFibGVQcm9wcy5Ub2tlblByb3BlcnRpZXNDYWNoaW5nRGJUYWJsZS5OYW1lLFxuICAgICAgICBwYXJ0aXRpb25LZXk6IHtcbiAgICAgICAgICBuYW1lOiBEeW5hbW9EQlRhYmxlUHJvcHMuVG9rZW5Qcm9wZXJ0aWVzQ2FjaGluZ0RiVGFibGUuUGFydGl0aW9uS2V5TmFtZSxcbiAgICAgICAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICAgICAgdGltZVRvTGl2ZUF0dHJpYnV0ZTogRHluYW1vREJUYWJsZVByb3BzLlRUTEF0dHJpYnV0ZU5hbWUsXG4gICAgICB9XG4gICAgKVxuICB9XG59XG4iXX0=