import { ChainId } from '@uniswap/sdk-core';
import { CachingGasStationProvider, CachingTokenListProvider, CachingTokenProviderWithFallback, CachingV3PoolProvider, EIP1559GasPriceProvider, FallbackTenderlySimulator, TenderlySimulator, EthEstimateGasSimulator, LegacyGasPriceProvider, NodeJSCache, OnChainGasPriceProvider, OnChainQuoteProvider, setGlobalLogger, StaticV2SubgraphProvider, StaticV3SubgraphProvider, TokenProvider, TokenPropertiesProvider, UniswapMulticallProvider, V2PoolProvider, V2QuoteProvider, V3PoolProvider, CachingV2PoolProvider, TokenValidatorProvider, } from '@uniswap/smart-order-router';
import { default as bunyan } from 'bunyan';
import _ from 'lodash';
import NodeCache from 'node-cache';
import UNSUPPORTED_TOKEN_LIST from './../config/unsupported.tokenlist.json';
import { Injector } from './handler';
import { V2AWSSubgraphProvider, V3AWSSubgraphProvider } from './router-entities/aws-subgraph-provider';
import { AWSTokenListProvider } from './router-entities/aws-token-list-provider';
import { DynamoRouteCachingProvider } from './router-entities/route-caching/dynamo-route-caching-provider';
import { DynamoDBCachingV3PoolProvider } from './pools/pool-caching/v3/dynamo-caching-pool-provider';
import { TrafficSwitchV3PoolProvider } from './pools/provider-migration/v3/traffic-switch-v3-pool-provider';
import { DefaultEVMClient } from './evm/EVMClient';
import { InstrumentedEVMProvider } from './evm/provider/InstrumentedEVMProvider';
import { deriveProviderName } from './evm/provider/ProviderName';
import { V2DynamoCache } from './pools/pool-caching/v2/v2-dynamo-cache';
import { OnChainTokenFeeFetcher } from '@uniswap/smart-order-router/build/main/providers/token-fee-fetcher';
import { PortionProvider } from '@uniswap/smart-order-router/build/main/providers/portion-provider';
export const SUPPORTED_CHAINS = [
    ChainId.MAINNET,
    ChainId.OPTIMISM,
    ChainId.ARBITRUM_ONE,
    ChainId.ARBITRUM_GOERLI,
    ChainId.POLYGON,
    ChainId.POLYGON_MUMBAI,
    ChainId.BNB_TESTNET,
    ChainId.GOERLI,
    ChainId.SEPOLIA,
    ChainId.CELO,
    ChainId.CELO_ALFAJORES,
    ChainId.BNB,
    ChainId.AVALANCHE,
    ChainId.BASE,
];
const DEFAULT_TOKEN_LIST = 'https://gateway.ipfs.io/ipns/tokens.uniswap.org';
export class InjectorSOR extends Injector {
    async buildContainerInjected() {
        const log = bunyan.createLogger({
            name: this.injectorName,
            serializers: bunyan.stdSerializers,
            level: bunyan.INFO,
        });
        setGlobalLogger(log);
        try {
            const { POOL_CACHE_BUCKET_2, POOL_CACHE_KEY, TOKEN_LIST_CACHE_BUCKET, ROUTES_TABLE_NAME, ROUTES_CACHING_REQUEST_FLAG_TABLE_NAME, CACHED_ROUTES_TABLE_NAME, AWS_LAMBDA_FUNCTION_NAME, V2_PAIRS_CACHE_TABLE_NAME, } = process.env;
            const dependenciesByChain = {};
            const dependenciesByChainArray = await Promise.all(_.map(SUPPORTED_CHAINS, async (chainId) => {
                const url = process.env[`WEB3_RPC_${chainId.toString()}`];
                if (!url) {
                    log.fatal({ chainId: chainId }, `Fatal: No Web3 RPC endpoint set for chain`);
                    return { chainId, dependencies: {} };
                    // This router instance will not be able to route through any chain
                    // for which RPC URL is not set
                    // For now, if RPC URL is not set for a chain, a request to route
                    // on the chain will return Err 500
                }
                let timeout;
                switch (chainId) {
                    case ChainId.ARBITRUM_ONE:
                        timeout = 8000;
                        break;
                    default:
                        timeout = 5000;
                        break;
                }
                const provider = new DefaultEVMClient({
                    allProviders: [
                        new InstrumentedEVMProvider({
                            url: {
                                url: url,
                                timeout,
                            },
                            network: chainId,
                            name: deriveProviderName(url),
                        }),
                    ],
                }).getProvider();
                const tokenCache = new NodeJSCache(new NodeCache({ stdTTL: 3600, useClones: false }));
                const blockedTokenCache = new NodeJSCache(new NodeCache({ stdTTL: 3600, useClones: false }));
                const multicall2Provider = new UniswapMulticallProvider(chainId, provider, 375000);
                const noCacheV3PoolProvider = new V3PoolProvider(chainId, multicall2Provider);
                const inMemoryCachingV3PoolProvider = new CachingV3PoolProvider(chainId, noCacheV3PoolProvider, new NodeJSCache(new NodeCache({ stdTTL: 180, useClones: false })));
                const dynamoCachingV3PoolProvider = new DynamoDBCachingV3PoolProvider(chainId, noCacheV3PoolProvider, 'V3PoolsCachingDB');
                const v3PoolProvider = new TrafficSwitchV3PoolProvider({
                    currentPoolProvider: inMemoryCachingV3PoolProvider,
                    targetPoolProvider: dynamoCachingV3PoolProvider,
                    sourceOfTruthPoolProvider: noCacheV3PoolProvider,
                });
                const tokenFeeFetcher = new OnChainTokenFeeFetcher(chainId, provider);
                const tokenValidatorProvider = new TokenValidatorProvider(chainId, multicall2Provider, new NodeJSCache(new NodeCache({ stdTTL: 30000, useClones: false })));
                const tokenPropertiesProvider = new TokenPropertiesProvider(chainId, new NodeJSCache(new NodeCache({ stdTTL: 30000, useClones: false })), tokenFeeFetcher);
                const underlyingV2PoolProvider = new V2PoolProvider(chainId, multicall2Provider, tokenPropertiesProvider);
                const v2PoolProvider = new CachingV2PoolProvider(chainId, underlyingV2PoolProvider, new V2DynamoCache(V2_PAIRS_CACHE_TABLE_NAME));
                const [tokenListProvider, blockedTokenListProvider, v3SubgraphProvider, v2SubgraphProvider] = await Promise.all([
                    AWSTokenListProvider.fromTokenListS3Bucket(chainId, TOKEN_LIST_CACHE_BUCKET, DEFAULT_TOKEN_LIST),
                    CachingTokenListProvider.fromTokenList(chainId, UNSUPPORTED_TOKEN_LIST, blockedTokenCache),
                    (async () => {
                        try {
                            const subgraphProvider = await V3AWSSubgraphProvider.EagerBuild(POOL_CACHE_BUCKET_2, POOL_CACHE_KEY, chainId);
                            return subgraphProvider;
                        }
                        catch (err) {
                            log.error({ err }, 'AWS Subgraph Provider unavailable, defaulting to Static Subgraph Provider');
                            return new StaticV3SubgraphProvider(chainId, v3PoolProvider);
                        }
                    })(),
                    (async () => {
                        try {
                            const subgraphProvider = await V2AWSSubgraphProvider.EagerBuild(POOL_CACHE_BUCKET_2, POOL_CACHE_KEY, chainId);
                            return subgraphProvider;
                        }
                        catch (err) {
                            return new StaticV2SubgraphProvider(chainId);
                        }
                    })(),
                ]);
                const tokenProvider = new CachingTokenProviderWithFallback(chainId, tokenCache, tokenListProvider, new TokenProvider(chainId, multicall2Provider));
                // Some providers like Infura set a gas limit per call of 10x block gas which is approx 150m
                // 200*725k < 150m
                let quoteProvider = undefined;
                switch (chainId) {
                    case ChainId.BASE:
                    case ChainId.OPTIMISM:
                        quoteProvider = new OnChainQuoteProvider(chainId, provider, multicall2Provider, {
                            retries: 2,
                            minTimeout: 100,
                            maxTimeout: 1000,
                        }, {
                            multicallChunk: 110,
                            gasLimitPerCall: 1200000,
                            quoteMinSuccessRate: 0.1,
                        }, {
                            gasLimitOverride: 3000000,
                            multicallChunk: 45,
                        }, {
                            gasLimitOverride: 3000000,
                            multicallChunk: 45,
                        }, {
                            baseBlockOffset: -25,
                            rollback: {
                                enabled: true,
                                attemptsBeforeRollback: 1,
                                rollbackBlockOffset: -20,
                            },
                        });
                        break;
                    case ChainId.ARBITRUM_ONE:
                        quoteProvider = new OnChainQuoteProvider(chainId, provider, multicall2Provider, {
                            retries: 2,
                            minTimeout: 100,
                            maxTimeout: 1000,
                        }, {
                            multicallChunk: 15,
                            gasLimitPerCall: 15000000,
                            quoteMinSuccessRate: 0.15,
                        }, {
                            gasLimitOverride: 30000000,
                            multicallChunk: 8,
                        }, {
                            gasLimitOverride: 30000000,
                            multicallChunk: 8,
                        }, {
                            baseBlockOffset: 0,
                            rollback: {
                                enabled: true,
                                attemptsBeforeRollback: 1,
                                rollbackBlockOffset: -10,
                            },
                        });
                        break;
                }
                const portionProvider = new PortionProvider();
                const tenderlySimulator = new TenderlySimulator(chainId, 'https://api.tenderly.co', process.env.TENDERLY_USER, process.env.TENDERLY_PROJECT, process.env.TENDERLY_ACCESS_KEY, v2PoolProvider, v3PoolProvider, provider, portionProvider, { [ChainId.ARBITRUM_ONE]: 2.5 }, 
                // The timeout for the underlying axios call to Tenderly, measured in milliseconds.
                2.5 * 1000);
                const ethEstimateGasSimulator = new EthEstimateGasSimulator(chainId, provider, v2PoolProvider, v3PoolProvider, portionProvider);
                const simulator = new FallbackTenderlySimulator(chainId, provider, portionProvider, tenderlySimulator, ethEstimateGasSimulator);
                let routeCachingProvider = undefined;
                if (CACHED_ROUTES_TABLE_NAME && CACHED_ROUTES_TABLE_NAME !== '') {
                    routeCachingProvider = new DynamoRouteCachingProvider({
                        routesTableName: ROUTES_TABLE_NAME,
                        routesCachingRequestFlagTableName: ROUTES_CACHING_REQUEST_FLAG_TABLE_NAME,
                        cachingQuoteLambdaName: AWS_LAMBDA_FUNCTION_NAME,
                    });
                }
                return {
                    chainId,
                    dependencies: {
                        provider,
                        tokenListProvider,
                        blockedTokenListProvider,
                        multicallProvider: multicall2Provider,
                        tokenProvider,
                        tokenProviderFromTokenList: tokenListProvider,
                        gasPriceProvider: new CachingGasStationProvider(chainId, new OnChainGasPriceProvider(chainId, new EIP1559GasPriceProvider(provider), new LegacyGasPriceProvider(provider)), new NodeJSCache(new NodeCache({ stdTTL: 15, useClones: false }))),
                        v3SubgraphProvider,
                        onChainQuoteProvider: quoteProvider,
                        v3PoolProvider,
                        v2PoolProvider,
                        v2QuoteProvider: new V2QuoteProvider(),
                        v2SubgraphProvider,
                        simulator,
                        routeCachingProvider,
                        tokenValidatorProvider,
                        tokenPropertiesProvider,
                    },
                };
            }));
            for (const { chainId, dependencies } of dependenciesByChainArray) {
                dependenciesByChain[chainId] = dependencies;
            }
            return {
                dependencies: dependenciesByChain,
            };
        }
        catch (err) {
            log.fatal({ err }, `Fatal: Failed to build container`);
            throw err;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5qZWN0b3Itc29yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL2hhbmRsZXJzL2luamVjdG9yLXNvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFTLE1BQU0sbUJBQW1CLENBQUE7QUFDbEQsT0FBTyxFQUNMLHlCQUF5QixFQUN6Qix3QkFBd0IsRUFDeEIsZ0NBQWdDLEVBQ2hDLHFCQUFxQixFQUNyQix1QkFBdUIsRUFDdkIseUJBQXlCLEVBQ3pCLGlCQUFpQixFQUNqQix1QkFBdUIsRUFVdkIsc0JBQXNCLEVBQ3RCLFdBQVcsRUFDWCx1QkFBdUIsRUFDdkIsb0JBQW9CLEVBQ3BCLGVBQWUsRUFDZix3QkFBd0IsRUFDeEIsd0JBQXdCLEVBQ3hCLGFBQWEsRUFDYix1QkFBdUIsRUFDdkIsd0JBQXdCLEVBQ3hCLGNBQWMsRUFDZCxlQUFlLEVBQ2YsY0FBYyxFQUVkLHFCQUFxQixFQUNyQixzQkFBc0IsR0FFdkIsTUFBTSw2QkFBNkIsQ0FBQTtBQUVwQyxPQUFPLEVBQUUsT0FBTyxJQUFJLE1BQU0sRUFBcUIsTUFBTSxRQUFRLENBQUE7QUFFN0QsT0FBTyxDQUFDLE1BQU0sUUFBUSxDQUFBO0FBQ3RCLE9BQU8sU0FBUyxNQUFNLFlBQVksQ0FBQTtBQUNsQyxPQUFPLHNCQUFzQixNQUFNLHdDQUF3QyxDQUFBO0FBQzNFLE9BQU8sRUFBWSxRQUFRLEVBQUUsTUFBTSxXQUFXLENBQUE7QUFDOUMsT0FBTyxFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixFQUFFLE1BQU0seUNBQXlDLENBQUE7QUFDdEcsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sMkNBQTJDLENBQUE7QUFDaEYsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sK0RBQStELENBQUE7QUFDMUcsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sc0RBQXNELENBQUE7QUFDcEcsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sK0RBQStELENBQUE7QUFDM0csT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0saUJBQWlCLENBQUE7QUFDbEQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sd0NBQXdDLENBQUE7QUFDaEYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNkJBQTZCLENBQUE7QUFDaEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHlDQUF5QyxDQUFBO0FBQ3ZFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLG9FQUFvRSxDQUFBO0FBQzNHLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtRUFBbUUsQ0FBQTtBQUVuRyxNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBYztJQUN6QyxPQUFPLENBQUMsT0FBTztJQUNmLE9BQU8sQ0FBQyxRQUFRO0lBQ2hCLE9BQU8sQ0FBQyxZQUFZO0lBQ3BCLE9BQU8sQ0FBQyxlQUFlO0lBQ3ZCLE9BQU8sQ0FBQyxPQUFPO0lBQ2YsT0FBTyxDQUFDLGNBQWM7SUFDdEIsT0FBTyxDQUFDLFdBQVc7SUFDbkIsT0FBTyxDQUFDLE1BQU07SUFDZCxPQUFPLENBQUMsT0FBTztJQUNmLE9BQU8sQ0FBQyxJQUFJO0lBQ1osT0FBTyxDQUFDLGNBQWM7SUFDdEIsT0FBTyxDQUFDLEdBQUc7SUFDWCxPQUFPLENBQUMsU0FBUztJQUNqQixPQUFPLENBQUMsSUFBSTtDQUNiLENBQUE7QUFDRCxNQUFNLGtCQUFrQixHQUFHLGlEQUFpRCxDQUFBO0FBd0M1RSxNQUFNLE9BQWdCLFdBQWlDLFNBQVEsUUFLOUQ7SUFDUSxLQUFLLENBQUMsc0JBQXNCO1FBQ2pDLE1BQU0sR0FBRyxHQUFXLE1BQU0sQ0FBQyxZQUFZLENBQUM7WUFDdEMsSUFBSSxFQUFFLElBQUksQ0FBQyxZQUFZO1lBQ3ZCLFdBQVcsRUFBRSxNQUFNLENBQUMsY0FBYztZQUNsQyxLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUk7U0FDbkIsQ0FBQyxDQUFBO1FBQ0YsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBRXBCLElBQUk7WUFDRixNQUFNLEVBQ0osbUJBQW1CLEVBQ25CLGNBQWMsRUFDZCx1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLHNDQUFzQyxFQUN0Qyx3QkFBd0IsRUFDeEIsd0JBQXdCLEVBQ3hCLHlCQUF5QixHQUMxQixHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUE7WUFFZixNQUFNLG1CQUFtQixHQUVyQixFQUFFLENBQUE7WUFFTixNQUFNLHdCQUF3QixHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FDaEQsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsT0FBZ0IsRUFBRSxFQUFFO2dCQUNqRCxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUUsQ0FBQTtnQkFDMUQsSUFBSSxDQUFDLEdBQUcsRUFBRTtvQkFDUixHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLDJDQUEyQyxDQUFDLENBQUE7b0JBQzVFLE9BQU8sRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLEVBQTJCLEVBQUUsQ0FBQTtvQkFDN0QsbUVBQW1FO29CQUNuRSwrQkFBK0I7b0JBQy9CLGlFQUFpRTtvQkFDakUsbUNBQW1DO2lCQUNwQztnQkFFRCxJQUFJLE9BQWUsQ0FBQTtnQkFDbkIsUUFBUSxPQUFPLEVBQUU7b0JBQ2YsS0FBSyxPQUFPLENBQUMsWUFBWTt3QkFDdkIsT0FBTyxHQUFHLElBQUksQ0FBQTt3QkFDZCxNQUFLO29CQUNQO3dCQUNFLE9BQU8sR0FBRyxJQUFJLENBQUE7d0JBQ2QsTUFBSztpQkFDUjtnQkFFRCxNQUFNLFFBQVEsR0FBRyxJQUFJLGdCQUFnQixDQUFDO29CQUNwQyxZQUFZLEVBQUU7d0JBQ1osSUFBSSx1QkFBdUIsQ0FBQzs0QkFDMUIsR0FBRyxFQUFFO2dDQUNILEdBQUcsRUFBRSxHQUFHO2dDQUNSLE9BQU87NkJBQ1I7NEJBQ0QsT0FBTyxFQUFFLE9BQU87NEJBQ2hCLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxHQUFHLENBQUM7eUJBQzlCLENBQUM7cUJBQ0g7aUJBQ0YsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO2dCQUVoQixNQUFNLFVBQVUsR0FBRyxJQUFJLFdBQVcsQ0FBUSxJQUFJLFNBQVMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFDNUYsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLFdBQVcsQ0FBUSxJQUFJLFNBQVMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFDbkcsTUFBTSxrQkFBa0IsR0FBRyxJQUFJLHdCQUF3QixDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTyxDQUFDLENBQUE7Z0JBRW5GLE1BQU0scUJBQXFCLEdBQUcsSUFBSSxjQUFjLENBQUMsT0FBTyxFQUFFLGtCQUFrQixDQUFDLENBQUE7Z0JBQzdFLE1BQU0sNkJBQTZCLEdBQUcsSUFBSSxxQkFBcUIsQ0FDN0QsT0FBTyxFQUNQLHFCQUFxQixFQUNyQixJQUFJLFdBQVcsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FDbEUsQ0FBQTtnQkFDRCxNQUFNLDJCQUEyQixHQUFHLElBQUksNkJBQTZCLENBQ25FLE9BQU8sRUFDUCxxQkFBcUIsRUFDckIsa0JBQWtCLENBQ25CLENBQUE7Z0JBRUQsTUFBTSxjQUFjLEdBQUcsSUFBSSwyQkFBMkIsQ0FBQztvQkFDckQsbUJBQW1CLEVBQUUsNkJBQTZCO29CQUNsRCxrQkFBa0IsRUFBRSwyQkFBMkI7b0JBQy9DLHlCQUF5QixFQUFFLHFCQUFxQjtpQkFDakQsQ0FBQyxDQUFBO2dCQUVGLE1BQU0sZUFBZSxHQUFHLElBQUksc0JBQXNCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFBO2dCQUNyRSxNQUFNLHNCQUFzQixHQUFHLElBQUksc0JBQXNCLENBQ3ZELE9BQU8sRUFDUCxrQkFBa0IsRUFDbEIsSUFBSSxXQUFXLENBQUMsSUFBSSxTQUFTLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQ3BFLENBQUE7Z0JBQ0QsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLHVCQUF1QixDQUN6RCxPQUFPLEVBQ1AsSUFBSSxXQUFXLENBQUMsSUFBSSxTQUFTLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLEVBQ25FLGVBQWUsQ0FDaEIsQ0FBQTtnQkFDRCxNQUFNLHdCQUF3QixHQUFHLElBQUksY0FBYyxDQUFDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSx1QkFBdUIsQ0FBQyxDQUFBO2dCQUN6RyxNQUFNLGNBQWMsR0FBRyxJQUFJLHFCQUFxQixDQUM5QyxPQUFPLEVBQ1Asd0JBQXdCLEVBQ3hCLElBQUksYUFBYSxDQUFDLHlCQUEwQixDQUFDLENBQzlDLENBQUE7Z0JBRUQsTUFBTSxDQUFDLGlCQUFpQixFQUFFLHdCQUF3QixFQUFFLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLEdBQ3pGLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQztvQkFDaEIsb0JBQW9CLENBQUMscUJBQXFCLENBQUMsT0FBTyxFQUFFLHVCQUF3QixFQUFFLGtCQUFrQixDQUFDO29CQUNqRyx3QkFBd0IsQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLHNCQUFtQyxFQUFFLGlCQUFpQixDQUFDO29CQUN2RyxDQUFDLEtBQUssSUFBSSxFQUFFO3dCQUNWLElBQUk7NEJBQ0YsTUFBTSxnQkFBZ0IsR0FBRyxNQUFNLHFCQUFxQixDQUFDLFVBQVUsQ0FDN0QsbUJBQW9CLEVBQ3BCLGNBQWUsRUFDZixPQUFPLENBQ1IsQ0FBQTs0QkFDRCxPQUFPLGdCQUFnQixDQUFBO3lCQUN4Qjt3QkFBQyxPQUFPLEdBQUcsRUFBRTs0QkFDWixHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsMkVBQTJFLENBQUMsQ0FBQTs0QkFDL0YsT0FBTyxJQUFJLHdCQUF3QixDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQTt5QkFDN0Q7b0JBQ0gsQ0FBQyxDQUFDLEVBQUU7b0JBQ0osQ0FBQyxLQUFLLElBQUksRUFBRTt3QkFDVixJQUFJOzRCQUNGLE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxxQkFBcUIsQ0FBQyxVQUFVLENBQzdELG1CQUFvQixFQUNwQixjQUFlLEVBQ2YsT0FBTyxDQUNSLENBQUE7NEJBQ0QsT0FBTyxnQkFBZ0IsQ0FBQTt5QkFDeEI7d0JBQUMsT0FBTyxHQUFHLEVBQUU7NEJBQ1osT0FBTyxJQUFJLHdCQUF3QixDQUFDLE9BQU8sQ0FBQyxDQUFBO3lCQUM3QztvQkFDSCxDQUFDLENBQUMsRUFBRTtpQkFDTCxDQUFDLENBQUE7Z0JBRUosTUFBTSxhQUFhLEdBQUcsSUFBSSxnQ0FBZ0MsQ0FDeEQsT0FBTyxFQUNQLFVBQVUsRUFDVixpQkFBaUIsRUFDakIsSUFBSSxhQUFhLENBQUMsT0FBTyxFQUFFLGtCQUFrQixDQUFDLENBQy9DLENBQUE7Z0JBRUQsNEZBQTRGO2dCQUM1RixrQkFBa0I7Z0JBQ2xCLElBQUksYUFBYSxHQUFxQyxTQUFTLENBQUE7Z0JBQy9ELFFBQVEsT0FBTyxFQUFFO29CQUNmLEtBQUssT0FBTyxDQUFDLElBQUksQ0FBQztvQkFDbEIsS0FBSyxPQUFPLENBQUMsUUFBUTt3QkFDbkIsYUFBYSxHQUFHLElBQUksb0JBQW9CLENBQ3RDLE9BQU8sRUFDUCxRQUFRLEVBQ1Isa0JBQWtCLEVBQ2xCOzRCQUNFLE9BQU8sRUFBRSxDQUFDOzRCQUNWLFVBQVUsRUFBRSxHQUFHOzRCQUNmLFVBQVUsRUFBRSxJQUFJO3lCQUNqQixFQUNEOzRCQUNFLGNBQWMsRUFBRSxHQUFHOzRCQUNuQixlQUFlLEVBQUUsT0FBUzs0QkFDMUIsbUJBQW1CLEVBQUUsR0FBRzt5QkFDekIsRUFDRDs0QkFDRSxnQkFBZ0IsRUFBRSxPQUFTOzRCQUMzQixjQUFjLEVBQUUsRUFBRTt5QkFDbkIsRUFDRDs0QkFDRSxnQkFBZ0IsRUFBRSxPQUFTOzRCQUMzQixjQUFjLEVBQUUsRUFBRTt5QkFDbkIsRUFDRDs0QkFDRSxlQUFlLEVBQUUsQ0FBQyxFQUFFOzRCQUNwQixRQUFRLEVBQUU7Z0NBQ1IsT0FBTyxFQUFFLElBQUk7Z0NBQ2Isc0JBQXNCLEVBQUUsQ0FBQztnQ0FDekIsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFOzZCQUN6Qjt5QkFDRixDQUNGLENBQUE7d0JBQ0QsTUFBSztvQkFDUCxLQUFLLE9BQU8sQ0FBQyxZQUFZO3dCQUN2QixhQUFhLEdBQUcsSUFBSSxvQkFBb0IsQ0FDdEMsT0FBTyxFQUNQLFFBQVEsRUFDUixrQkFBa0IsRUFDbEI7NEJBQ0UsT0FBTyxFQUFFLENBQUM7NEJBQ1YsVUFBVSxFQUFFLEdBQUc7NEJBQ2YsVUFBVSxFQUFFLElBQUk7eUJBQ2pCLEVBQ0Q7NEJBQ0UsY0FBYyxFQUFFLEVBQUU7NEJBQ2xCLGVBQWUsRUFBRSxRQUFVOzRCQUMzQixtQkFBbUIsRUFBRSxJQUFJO3lCQUMxQixFQUNEOzRCQUNFLGdCQUFnQixFQUFFLFFBQVU7NEJBQzVCLGNBQWMsRUFBRSxDQUFDO3lCQUNsQixFQUNEOzRCQUNFLGdCQUFnQixFQUFFLFFBQVU7NEJBQzVCLGNBQWMsRUFBRSxDQUFDO3lCQUNsQixFQUNEOzRCQUNFLGVBQWUsRUFBRSxDQUFDOzRCQUNsQixRQUFRLEVBQUU7Z0NBQ1IsT0FBTyxFQUFFLElBQUk7Z0NBQ2Isc0JBQXNCLEVBQUUsQ0FBQztnQ0FDekIsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFOzZCQUN6Qjt5QkFDRixDQUNGLENBQUE7d0JBQ0QsTUFBSztpQkFDUjtnQkFFRCxNQUFNLGVBQWUsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFBO2dCQUM3QyxNQUFNLGlCQUFpQixHQUFHLElBQUksaUJBQWlCLENBQzdDLE9BQU8sRUFDUCx5QkFBeUIsRUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFjLEVBQzFCLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWlCLEVBQzdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW9CLEVBQ2hDLGNBQWMsRUFDZCxjQUFjLEVBQ2QsUUFBUSxFQUNSLGVBQWUsRUFDZixFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxFQUFFLEdBQUcsRUFBRTtnQkFDL0IsbUZBQW1GO2dCQUNuRixHQUFHLEdBQUcsSUFBSSxDQUNYLENBQUE7Z0JBRUQsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLHVCQUF1QixDQUN6RCxPQUFPLEVBQ1AsUUFBUSxFQUNSLGNBQWMsRUFDZCxjQUFjLEVBQ2QsZUFBZSxDQUNoQixDQUFBO2dCQUVELE1BQU0sU0FBUyxHQUFHLElBQUkseUJBQXlCLENBQzdDLE9BQU8sRUFDUCxRQUFRLEVBQ1IsZUFBZSxFQUNmLGlCQUFpQixFQUNqQix1QkFBdUIsQ0FDeEIsQ0FBQTtnQkFFRCxJQUFJLG9CQUFvQixHQUFzQyxTQUFTLENBQUE7Z0JBQ3ZFLElBQUksd0JBQXdCLElBQUksd0JBQXdCLEtBQUssRUFBRSxFQUFFO29CQUMvRCxvQkFBb0IsR0FBRyxJQUFJLDBCQUEwQixDQUFDO3dCQUNwRCxlQUFlLEVBQUUsaUJBQWtCO3dCQUNuQyxpQ0FBaUMsRUFBRSxzQ0FBdUM7d0JBQzFFLHNCQUFzQixFQUFFLHdCQUF5QjtxQkFDbEQsQ0FBQyxDQUFBO2lCQUNIO2dCQUVELE9BQU87b0JBQ0wsT0FBTztvQkFDUCxZQUFZLEVBQUU7d0JBQ1osUUFBUTt3QkFDUixpQkFBaUI7d0JBQ2pCLHdCQUF3Qjt3QkFDeEIsaUJBQWlCLEVBQUUsa0JBQWtCO3dCQUNyQyxhQUFhO3dCQUNiLDBCQUEwQixFQUFFLGlCQUFpQjt3QkFDN0MsZ0JBQWdCLEVBQUUsSUFBSSx5QkFBeUIsQ0FDN0MsT0FBTyxFQUNQLElBQUksdUJBQXVCLENBQ3pCLE9BQU8sRUFDUCxJQUFJLHVCQUF1QixDQUFDLFFBQVEsQ0FBQyxFQUNyQyxJQUFJLHNCQUFzQixDQUFDLFFBQVEsQ0FBQyxDQUNyQyxFQUNELElBQUksV0FBVyxDQUFDLElBQUksU0FBUyxDQUFDLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUNqRTt3QkFDRCxrQkFBa0I7d0JBQ2xCLG9CQUFvQixFQUFFLGFBQWE7d0JBQ25DLGNBQWM7d0JBQ2QsY0FBYzt3QkFDZCxlQUFlLEVBQUUsSUFBSSxlQUFlLEVBQUU7d0JBQ3RDLGtCQUFrQjt3QkFDbEIsU0FBUzt3QkFDVCxvQkFBb0I7d0JBQ3BCLHNCQUFzQjt3QkFDdEIsdUJBQXVCO3FCQUN4QjtpQkFDRixDQUFBO1lBQ0gsQ0FBQyxDQUFDLENBQ0gsQ0FBQTtZQUVELEtBQUssTUFBTSxFQUFFLE9BQU8sRUFBRSxZQUFZLEVBQUUsSUFBSSx3QkFBd0IsRUFBRTtnQkFDaEUsbUJBQW1CLENBQUMsT0FBTyxDQUFDLEdBQUcsWUFBWSxDQUFBO2FBQzVDO1lBRUQsT0FBTztnQkFDTCxZQUFZLEVBQUUsbUJBQW1CO2FBQ2xDLENBQUE7U0FDRjtRQUFDLE9BQU8sR0FBRyxFQUFFO1lBQ1osR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLGtDQUFrQyxDQUFDLENBQUE7WUFDdEQsTUFBTSxHQUFHLENBQUE7U0FDVjtJQUNILENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYWluSWQsIFRva2VuIH0gZnJvbSAnQHVuaXN3YXAvc2RrLWNvcmUnXG5pbXBvcnQge1xuICBDYWNoaW5nR2FzU3RhdGlvblByb3ZpZGVyLFxuICBDYWNoaW5nVG9rZW5MaXN0UHJvdmlkZXIsXG4gIENhY2hpbmdUb2tlblByb3ZpZGVyV2l0aEZhbGxiYWNrLFxuICBDYWNoaW5nVjNQb29sUHJvdmlkZXIsXG4gIEVJUDE1NTlHYXNQcmljZVByb3ZpZGVyLFxuICBGYWxsYmFja1RlbmRlcmx5U2ltdWxhdG9yLFxuICBUZW5kZXJseVNpbXVsYXRvcixcbiAgRXRoRXN0aW1hdGVHYXNTaW11bGF0b3IsXG4gIElHYXNQcmljZVByb3ZpZGVyLFxuICBJTWV0cmljLFxuICBTaW11bGF0b3IsXG4gIElUb2tlbkxpc3RQcm92aWRlcixcbiAgSVRva2VuUHJvdmlkZXIsXG4gIElWMlBvb2xQcm92aWRlcixcbiAgSVYyU3ViZ3JhcGhQcm92aWRlcixcbiAgSVYzUG9vbFByb3ZpZGVyLFxuICBJVjNTdWJncmFwaFByb3ZpZGVyLFxuICBMZWdhY3lHYXNQcmljZVByb3ZpZGVyLFxuICBOb2RlSlNDYWNoZSxcbiAgT25DaGFpbkdhc1ByaWNlUHJvdmlkZXIsXG4gIE9uQ2hhaW5RdW90ZVByb3ZpZGVyLFxuICBzZXRHbG9iYWxMb2dnZXIsXG4gIFN0YXRpY1YyU3ViZ3JhcGhQcm92aWRlcixcbiAgU3RhdGljVjNTdWJncmFwaFByb3ZpZGVyLFxuICBUb2tlblByb3ZpZGVyLFxuICBUb2tlblByb3BlcnRpZXNQcm92aWRlcixcbiAgVW5pc3dhcE11bHRpY2FsbFByb3ZpZGVyLFxuICBWMlBvb2xQcm92aWRlcixcbiAgVjJRdW90ZVByb3ZpZGVyLFxuICBWM1Bvb2xQcm92aWRlcixcbiAgSVJvdXRlQ2FjaGluZ1Byb3ZpZGVyLFxuICBDYWNoaW5nVjJQb29sUHJvdmlkZXIsXG4gIFRva2VuVmFsaWRhdG9yUHJvdmlkZXIsXG4gIElUb2tlblByb3BlcnRpZXNQcm92aWRlcixcbn0gZnJvbSAnQHVuaXN3YXAvc21hcnQtb3JkZXItcm91dGVyJ1xuaW1wb3J0IHsgVG9rZW5MaXN0IH0gZnJvbSAnQHVuaXN3YXAvdG9rZW4tbGlzdHMnXG5pbXBvcnQgeyBkZWZhdWx0IGFzIGJ1bnlhbiwgZGVmYXVsdCBhcyBMb2dnZXIgfSBmcm9tICdidW55YW4nXG5pbXBvcnQgeyBldGhlcnMgfSBmcm9tICdldGhlcnMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgTm9kZUNhY2hlIGZyb20gJ25vZGUtY2FjaGUnXG5pbXBvcnQgVU5TVVBQT1JURURfVE9LRU5fTElTVCBmcm9tICcuLy4uL2NvbmZpZy91bnN1cHBvcnRlZC50b2tlbmxpc3QuanNvbidcbmltcG9ydCB7IEJhc2VSSW5qLCBJbmplY3RvciB9IGZyb20gJy4vaGFuZGxlcidcbmltcG9ydCB7IFYyQVdTU3ViZ3JhcGhQcm92aWRlciwgVjNBV1NTdWJncmFwaFByb3ZpZGVyIH0gZnJvbSAnLi9yb3V0ZXItZW50aXRpZXMvYXdzLXN1YmdyYXBoLXByb3ZpZGVyJ1xuaW1wb3J0IHsgQVdTVG9rZW5MaXN0UHJvdmlkZXIgfSBmcm9tICcuL3JvdXRlci1lbnRpdGllcy9hd3MtdG9rZW4tbGlzdC1wcm92aWRlcidcbmltcG9ydCB7IER5bmFtb1JvdXRlQ2FjaGluZ1Byb3ZpZGVyIH0gZnJvbSAnLi9yb3V0ZXItZW50aXRpZXMvcm91dGUtY2FjaGluZy9keW5hbW8tcm91dGUtY2FjaGluZy1wcm92aWRlcidcbmltcG9ydCB7IER5bmFtb0RCQ2FjaGluZ1YzUG9vbFByb3ZpZGVyIH0gZnJvbSAnLi9wb29scy9wb29sLWNhY2hpbmcvdjMvZHluYW1vLWNhY2hpbmctcG9vbC1wcm92aWRlcidcbmltcG9ydCB7IFRyYWZmaWNTd2l0Y2hWM1Bvb2xQcm92aWRlciB9IGZyb20gJy4vcG9vbHMvcHJvdmlkZXItbWlncmF0aW9uL3YzL3RyYWZmaWMtc3dpdGNoLXYzLXBvb2wtcHJvdmlkZXInXG5pbXBvcnQgeyBEZWZhdWx0RVZNQ2xpZW50IH0gZnJvbSAnLi9ldm0vRVZNQ2xpZW50J1xuaW1wb3J0IHsgSW5zdHJ1bWVudGVkRVZNUHJvdmlkZXIgfSBmcm9tICcuL2V2bS9wcm92aWRlci9JbnN0cnVtZW50ZWRFVk1Qcm92aWRlcidcbmltcG9ydCB7IGRlcml2ZVByb3ZpZGVyTmFtZSB9IGZyb20gJy4vZXZtL3Byb3ZpZGVyL1Byb3ZpZGVyTmFtZSdcbmltcG9ydCB7IFYyRHluYW1vQ2FjaGUgfSBmcm9tICcuL3Bvb2xzL3Bvb2wtY2FjaGluZy92Mi92Mi1keW5hbW8tY2FjaGUnXG5pbXBvcnQgeyBPbkNoYWluVG9rZW5GZWVGZXRjaGVyIH0gZnJvbSAnQHVuaXN3YXAvc21hcnQtb3JkZXItcm91dGVyL2J1aWxkL21haW4vcHJvdmlkZXJzL3Rva2VuLWZlZS1mZXRjaGVyJ1xuaW1wb3J0IHsgUG9ydGlvblByb3ZpZGVyIH0gZnJvbSAnQHVuaXN3YXAvc21hcnQtb3JkZXItcm91dGVyL2J1aWxkL21haW4vcHJvdmlkZXJzL3BvcnRpb24tcHJvdmlkZXInXG5cbmV4cG9ydCBjb25zdCBTVVBQT1JURURfQ0hBSU5TOiBDaGFpbklkW10gPSBbXG4gIENoYWluSWQuTUFJTk5FVCxcbiAgQ2hhaW5JZC5PUFRJTUlTTSxcbiAgQ2hhaW5JZC5BUkJJVFJVTV9PTkUsXG4gIENoYWluSWQuQVJCSVRSVU1fR09FUkxJLFxuICBDaGFpbklkLlBPTFlHT04sXG4gIENoYWluSWQuUE9MWUdPTl9NVU1CQUksXG4gIENoYWluSWQuQk5CX1RFU1RORVQsXG4gIENoYWluSWQuR09FUkxJLFxuICBDaGFpbklkLlNFUE9MSUEsXG4gIENoYWluSWQuQ0VMTyxcbiAgQ2hhaW5JZC5DRUxPX0FMRkFKT1JFUyxcbiAgQ2hhaW5JZC5CTkIsXG4gIENoYWluSWQuQVZBTEFOQ0hFLFxuICBDaGFpbklkLkJBU0UsXG5dXG5jb25zdCBERUZBVUxUX1RPS0VOX0xJU1QgPSAnaHR0cHM6Ly9nYXRld2F5LmlwZnMuaW8vaXBucy90b2tlbnMudW5pc3dhcC5vcmcnXG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVxdWVzdEluamVjdGVkPFJvdXRlcj4gZXh0ZW5kcyBCYXNlUkluaiB7XG4gIGNoYWluSWQ6IENoYWluSWRcbiAgbWV0cmljOiBJTWV0cmljXG4gIHYzUG9vbFByb3ZpZGVyOiBJVjNQb29sUHJvdmlkZXJcbiAgdjJQb29sUHJvdmlkZXI6IElWMlBvb2xQcm92aWRlclxuICB0b2tlblByb3ZpZGVyOiBJVG9rZW5Qcm92aWRlclxuICB0b2tlbkxpc3RQcm92aWRlcjogSVRva2VuTGlzdFByb3ZpZGVyXG4gIHJvdXRlcjogUm91dGVyXG4gIHF1b3RlU3BlZWQ/OiBzdHJpbmdcbiAgaW50ZW50Pzogc3RyaW5nXG59XG5cbmV4cG9ydCB0eXBlIENvbnRhaW5lckRlcGVuZGVuY2llcyA9IHtcbiAgcHJvdmlkZXI6IGV0aGVycy5wcm92aWRlcnMuU3RhdGljSnNvblJwY1Byb3ZpZGVyXG4gIHYzU3ViZ3JhcGhQcm92aWRlcjogSVYzU3ViZ3JhcGhQcm92aWRlclxuICB2MlN1YmdyYXBoUHJvdmlkZXI6IElWMlN1YmdyYXBoUHJvdmlkZXJcbiAgdG9rZW5MaXN0UHJvdmlkZXI6IElUb2tlbkxpc3RQcm92aWRlclxuICBnYXNQcmljZVByb3ZpZGVyOiBJR2FzUHJpY2VQcm92aWRlclxuICB0b2tlblByb3ZpZGVyRnJvbVRva2VuTGlzdDogSVRva2VuUHJvdmlkZXJcbiAgYmxvY2tlZFRva2VuTGlzdFByb3ZpZGVyOiBJVG9rZW5MaXN0UHJvdmlkZXJcbiAgdjNQb29sUHJvdmlkZXI6IElWM1Bvb2xQcm92aWRlclxuICB2MlBvb2xQcm92aWRlcjogSVYyUG9vbFByb3ZpZGVyXG4gIHRva2VuUHJvdmlkZXI6IElUb2tlblByb3ZpZGVyXG4gIG11bHRpY2FsbFByb3ZpZGVyOiBVbmlzd2FwTXVsdGljYWxsUHJvdmlkZXJcbiAgb25DaGFpblF1b3RlUHJvdmlkZXI/OiBPbkNoYWluUXVvdGVQcm92aWRlclxuICB2MlF1b3RlUHJvdmlkZXI6IFYyUXVvdGVQcm92aWRlclxuICBzaW11bGF0b3I6IFNpbXVsYXRvclxuICByb3V0ZUNhY2hpbmdQcm92aWRlcj86IElSb3V0ZUNhY2hpbmdQcm92aWRlclxuICB0b2tlblZhbGlkYXRvclByb3ZpZGVyOiBUb2tlblZhbGlkYXRvclByb3ZpZGVyXG4gIHRva2VuUHJvcGVydGllc1Byb3ZpZGVyOiBJVG9rZW5Qcm9wZXJ0aWVzUHJvdmlkZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb250YWluZXJJbmplY3RlZCB7XG4gIGRlcGVuZGVuY2llczoge1xuICAgIFtjaGFpbklkIGluIENoYWluSWRdPzogQ29udGFpbmVyRGVwZW5kZW5jaWVzXG4gIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEluamVjdG9yU09SPFJvdXRlciwgUXVlcnlQYXJhbXM+IGV4dGVuZHMgSW5qZWN0b3I8XG4gIENvbnRhaW5lckluamVjdGVkLFxuICBSZXF1ZXN0SW5qZWN0ZWQ8Um91dGVyPixcbiAgdm9pZCxcbiAgUXVlcnlQYXJhbXNcbj4ge1xuICBwdWJsaWMgYXN5bmMgYnVpbGRDb250YWluZXJJbmplY3RlZCgpOiBQcm9taXNlPENvbnRhaW5lckluamVjdGVkPiB7XG4gICAgY29uc3QgbG9nOiBMb2dnZXIgPSBidW55YW4uY3JlYXRlTG9nZ2VyKHtcbiAgICAgIG5hbWU6IHRoaXMuaW5qZWN0b3JOYW1lLFxuICAgICAgc2VyaWFsaXplcnM6IGJ1bnlhbi5zdGRTZXJpYWxpemVycyxcbiAgICAgIGxldmVsOiBidW55YW4uSU5GTyxcbiAgICB9KVxuICAgIHNldEdsb2JhbExvZ2dlcihsb2cpXG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBQT09MX0NBQ0hFX0JVQ0tFVF8yLFxuICAgICAgICBQT09MX0NBQ0hFX0tFWSxcbiAgICAgICAgVE9LRU5fTElTVF9DQUNIRV9CVUNLRVQsXG4gICAgICAgIFJPVVRFU19UQUJMRV9OQU1FLFxuICAgICAgICBST1VURVNfQ0FDSElOR19SRVFVRVNUX0ZMQUdfVEFCTEVfTkFNRSxcbiAgICAgICAgQ0FDSEVEX1JPVVRFU19UQUJMRV9OQU1FLFxuICAgICAgICBBV1NfTEFNQkRBX0ZVTkNUSU9OX05BTUUsXG4gICAgICAgIFYyX1BBSVJTX0NBQ0hFX1RBQkxFX05BTUUsXG4gICAgICB9ID0gcHJvY2Vzcy5lbnZcblxuICAgICAgY29uc3QgZGVwZW5kZW5jaWVzQnlDaGFpbjoge1xuICAgICAgICBbY2hhaW5JZCBpbiBDaGFpbklkXT86IENvbnRhaW5lckRlcGVuZGVuY2llc1xuICAgICAgfSA9IHt9XG5cbiAgICAgIGNvbnN0IGRlcGVuZGVuY2llc0J5Q2hhaW5BcnJheSA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBfLm1hcChTVVBQT1JURURfQ0hBSU5TLCBhc3luYyAoY2hhaW5JZDogQ2hhaW5JZCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVybCA9IHByb2Nlc3MuZW52W2BXRUIzX1JQQ18ke2NoYWluSWQudG9TdHJpbmcoKX1gXSFcbiAgICAgICAgICBpZiAoIXVybCkge1xuICAgICAgICAgICAgbG9nLmZhdGFsKHsgY2hhaW5JZDogY2hhaW5JZCB9LCBgRmF0YWw6IE5vIFdlYjMgUlBDIGVuZHBvaW50IHNldCBmb3IgY2hhaW5gKVxuICAgICAgICAgICAgcmV0dXJuIHsgY2hhaW5JZCwgZGVwZW5kZW5jaWVzOiB7fSBhcyBDb250YWluZXJEZXBlbmRlbmNpZXMgfVxuICAgICAgICAgICAgLy8gVGhpcyByb3V0ZXIgaW5zdGFuY2Ugd2lsbCBub3QgYmUgYWJsZSB0byByb3V0ZSB0aHJvdWdoIGFueSBjaGFpblxuICAgICAgICAgICAgLy8gZm9yIHdoaWNoIFJQQyBVUkwgaXMgbm90IHNldFxuICAgICAgICAgICAgLy8gRm9yIG5vdywgaWYgUlBDIFVSTCBpcyBub3Qgc2V0IGZvciBhIGNoYWluLCBhIHJlcXVlc3QgdG8gcm91dGVcbiAgICAgICAgICAgIC8vIG9uIHRoZSBjaGFpbiB3aWxsIHJldHVybiBFcnIgNTAwXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGV0IHRpbWVvdXQ6IG51bWJlclxuICAgICAgICAgIHN3aXRjaCAoY2hhaW5JZCkge1xuICAgICAgICAgICAgY2FzZSBDaGFpbklkLkFSQklUUlVNX09ORTpcbiAgICAgICAgICAgICAgdGltZW91dCA9IDgwMDBcbiAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHRpbWVvdXQgPSA1MDAwXG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgRGVmYXVsdEVWTUNsaWVudCh7XG4gICAgICAgICAgICBhbGxQcm92aWRlcnM6IFtcbiAgICAgICAgICAgICAgbmV3IEluc3RydW1lbnRlZEVWTVByb3ZpZGVyKHtcbiAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgICAgdGltZW91dCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5ldHdvcms6IGNoYWluSWQsXG4gICAgICAgICAgICAgICAgbmFtZTogZGVyaXZlUHJvdmlkZXJOYW1lKHVybCksXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9KS5nZXRQcm92aWRlcigpXG5cbiAgICAgICAgICBjb25zdCB0b2tlbkNhY2hlID0gbmV3IE5vZGVKU0NhY2hlPFRva2VuPihuZXcgTm9kZUNhY2hlKHsgc3RkVFRMOiAzNjAwLCB1c2VDbG9uZXM6IGZhbHNlIH0pKVxuICAgICAgICAgIGNvbnN0IGJsb2NrZWRUb2tlbkNhY2hlID0gbmV3IE5vZGVKU0NhY2hlPFRva2VuPihuZXcgTm9kZUNhY2hlKHsgc3RkVFRMOiAzNjAwLCB1c2VDbG9uZXM6IGZhbHNlIH0pKVxuICAgICAgICAgIGNvbnN0IG11bHRpY2FsbDJQcm92aWRlciA9IG5ldyBVbmlzd2FwTXVsdGljYWxsUHJvdmlkZXIoY2hhaW5JZCwgcHJvdmlkZXIsIDM3NV8wMDApXG5cbiAgICAgICAgICBjb25zdCBub0NhY2hlVjNQb29sUHJvdmlkZXIgPSBuZXcgVjNQb29sUHJvdmlkZXIoY2hhaW5JZCwgbXVsdGljYWxsMlByb3ZpZGVyKVxuICAgICAgICAgIGNvbnN0IGluTWVtb3J5Q2FjaGluZ1YzUG9vbFByb3ZpZGVyID0gbmV3IENhY2hpbmdWM1Bvb2xQcm92aWRlcihcbiAgICAgICAgICAgIGNoYWluSWQsXG4gICAgICAgICAgICBub0NhY2hlVjNQb29sUHJvdmlkZXIsXG4gICAgICAgICAgICBuZXcgTm9kZUpTQ2FjaGUobmV3IE5vZGVDYWNoZSh7IHN0ZFRUTDogMTgwLCB1c2VDbG9uZXM6IGZhbHNlIH0pKVxuICAgICAgICAgIClcbiAgICAgICAgICBjb25zdCBkeW5hbW9DYWNoaW5nVjNQb29sUHJvdmlkZXIgPSBuZXcgRHluYW1vREJDYWNoaW5nVjNQb29sUHJvdmlkZXIoXG4gICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgbm9DYWNoZVYzUG9vbFByb3ZpZGVyLFxuICAgICAgICAgICAgJ1YzUG9vbHNDYWNoaW5nREInXG4gICAgICAgICAgKVxuXG4gICAgICAgICAgY29uc3QgdjNQb29sUHJvdmlkZXIgPSBuZXcgVHJhZmZpY1N3aXRjaFYzUG9vbFByb3ZpZGVyKHtcbiAgICAgICAgICAgIGN1cnJlbnRQb29sUHJvdmlkZXI6IGluTWVtb3J5Q2FjaGluZ1YzUG9vbFByb3ZpZGVyLFxuICAgICAgICAgICAgdGFyZ2V0UG9vbFByb3ZpZGVyOiBkeW5hbW9DYWNoaW5nVjNQb29sUHJvdmlkZXIsXG4gICAgICAgICAgICBzb3VyY2VPZlRydXRoUG9vbFByb3ZpZGVyOiBub0NhY2hlVjNQb29sUHJvdmlkZXIsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIGNvbnN0IHRva2VuRmVlRmV0Y2hlciA9IG5ldyBPbkNoYWluVG9rZW5GZWVGZXRjaGVyKGNoYWluSWQsIHByb3ZpZGVyKVxuICAgICAgICAgIGNvbnN0IHRva2VuVmFsaWRhdG9yUHJvdmlkZXIgPSBuZXcgVG9rZW5WYWxpZGF0b3JQcm92aWRlcihcbiAgICAgICAgICAgIGNoYWluSWQsXG4gICAgICAgICAgICBtdWx0aWNhbGwyUHJvdmlkZXIsXG4gICAgICAgICAgICBuZXcgTm9kZUpTQ2FjaGUobmV3IE5vZGVDYWNoZSh7IHN0ZFRUTDogMzAwMDAsIHVzZUNsb25lczogZmFsc2UgfSkpXG4gICAgICAgICAgKVxuICAgICAgICAgIGNvbnN0IHRva2VuUHJvcGVydGllc1Byb3ZpZGVyID0gbmV3IFRva2VuUHJvcGVydGllc1Byb3ZpZGVyKFxuICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgIG5ldyBOb2RlSlNDYWNoZShuZXcgTm9kZUNhY2hlKHsgc3RkVFRMOiAzMDAwMCwgdXNlQ2xvbmVzOiBmYWxzZSB9KSksXG4gICAgICAgICAgICB0b2tlbkZlZUZldGNoZXJcbiAgICAgICAgICApXG4gICAgICAgICAgY29uc3QgdW5kZXJseWluZ1YyUG9vbFByb3ZpZGVyID0gbmV3IFYyUG9vbFByb3ZpZGVyKGNoYWluSWQsIG11bHRpY2FsbDJQcm92aWRlciwgdG9rZW5Qcm9wZXJ0aWVzUHJvdmlkZXIpXG4gICAgICAgICAgY29uc3QgdjJQb29sUHJvdmlkZXIgPSBuZXcgQ2FjaGluZ1YyUG9vbFByb3ZpZGVyKFxuICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgIHVuZGVybHlpbmdWMlBvb2xQcm92aWRlcixcbiAgICAgICAgICAgIG5ldyBWMkR5bmFtb0NhY2hlKFYyX1BBSVJTX0NBQ0hFX1RBQkxFX05BTUUhKVxuICAgICAgICAgIClcblxuICAgICAgICAgIGNvbnN0IFt0b2tlbkxpc3RQcm92aWRlciwgYmxvY2tlZFRva2VuTGlzdFByb3ZpZGVyLCB2M1N1YmdyYXBoUHJvdmlkZXIsIHYyU3ViZ3JhcGhQcm92aWRlcl0gPVxuICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICBBV1NUb2tlbkxpc3RQcm92aWRlci5mcm9tVG9rZW5MaXN0UzNCdWNrZXQoY2hhaW5JZCwgVE9LRU5fTElTVF9DQUNIRV9CVUNLRVQhLCBERUZBVUxUX1RPS0VOX0xJU1QpLFxuICAgICAgICAgICAgICBDYWNoaW5nVG9rZW5MaXN0UHJvdmlkZXIuZnJvbVRva2VuTGlzdChjaGFpbklkLCBVTlNVUFBPUlRFRF9UT0tFTl9MSVNUIGFzIFRva2VuTGlzdCwgYmxvY2tlZFRva2VuQ2FjaGUpLFxuICAgICAgICAgICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBzdWJncmFwaFByb3ZpZGVyID0gYXdhaXQgVjNBV1NTdWJncmFwaFByb3ZpZGVyLkVhZ2VyQnVpbGQoXG4gICAgICAgICAgICAgICAgICAgIFBPT0xfQ0FDSEVfQlVDS0VUXzIhLFxuICAgICAgICAgICAgICAgICAgICBQT09MX0NBQ0hFX0tFWSEsXG4gICAgICAgICAgICAgICAgICAgIGNoYWluSWRcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJncmFwaFByb3ZpZGVyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoeyBlcnIgfSwgJ0FXUyBTdWJncmFwaCBQcm92aWRlciB1bmF2YWlsYWJsZSwgZGVmYXVsdGluZyB0byBTdGF0aWMgU3ViZ3JhcGggUHJvdmlkZXInKVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGF0aWNWM1N1YmdyYXBoUHJvdmlkZXIoY2hhaW5JZCwgdjNQb29sUHJvdmlkZXIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KSgpLFxuICAgICAgICAgICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBzdWJncmFwaFByb3ZpZGVyID0gYXdhaXQgVjJBV1NTdWJncmFwaFByb3ZpZGVyLkVhZ2VyQnVpbGQoXG4gICAgICAgICAgICAgICAgICAgIFBPT0xfQ0FDSEVfQlVDS0VUXzIhLFxuICAgICAgICAgICAgICAgICAgICBQT09MX0NBQ0hFX0tFWSEsXG4gICAgICAgICAgICAgICAgICAgIGNoYWluSWRcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJncmFwaFByb3ZpZGVyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0YXRpY1YyU3ViZ3JhcGhQcm92aWRlcihjaGFpbklkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSkoKSxcbiAgICAgICAgICAgIF0pXG5cbiAgICAgICAgICBjb25zdCB0b2tlblByb3ZpZGVyID0gbmV3IENhY2hpbmdUb2tlblByb3ZpZGVyV2l0aEZhbGxiYWNrKFxuICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgIHRva2VuQ2FjaGUsXG4gICAgICAgICAgICB0b2tlbkxpc3RQcm92aWRlcixcbiAgICAgICAgICAgIG5ldyBUb2tlblByb3ZpZGVyKGNoYWluSWQsIG11bHRpY2FsbDJQcm92aWRlcilcbiAgICAgICAgICApXG5cbiAgICAgICAgICAvLyBTb21lIHByb3ZpZGVycyBsaWtlIEluZnVyYSBzZXQgYSBnYXMgbGltaXQgcGVyIGNhbGwgb2YgMTB4IGJsb2NrIGdhcyB3aGljaCBpcyBhcHByb3ggMTUwbVxuICAgICAgICAgIC8vIDIwMCo3MjVrIDwgMTUwbVxuICAgICAgICAgIGxldCBxdW90ZVByb3ZpZGVyOiBPbkNoYWluUXVvdGVQcm92aWRlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxuICAgICAgICAgIHN3aXRjaCAoY2hhaW5JZCkge1xuICAgICAgICAgICAgY2FzZSBDaGFpbklkLkJBU0U6XG4gICAgICAgICAgICBjYXNlIENoYWluSWQuT1BUSU1JU006XG4gICAgICAgICAgICAgIHF1b3RlUHJvdmlkZXIgPSBuZXcgT25DaGFpblF1b3RlUHJvdmlkZXIoXG4gICAgICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgICAgICBtdWx0aWNhbGwyUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgcmV0cmllczogMixcbiAgICAgICAgICAgICAgICAgIG1pblRpbWVvdXQ6IDEwMCxcbiAgICAgICAgICAgICAgICAgIG1heFRpbWVvdXQ6IDEwMDAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBtdWx0aWNhbGxDaHVuazogMTEwLFxuICAgICAgICAgICAgICAgICAgZ2FzTGltaXRQZXJDYWxsOiAxXzIwMF8wMDAsXG4gICAgICAgICAgICAgICAgICBxdW90ZU1pblN1Y2Nlc3NSYXRlOiAwLjEsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBnYXNMaW1pdE92ZXJyaWRlOiAzXzAwMF8wMDAsXG4gICAgICAgICAgICAgICAgICBtdWx0aWNhbGxDaHVuazogNDUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBnYXNMaW1pdE92ZXJyaWRlOiAzXzAwMF8wMDAsXG4gICAgICAgICAgICAgICAgICBtdWx0aWNhbGxDaHVuazogNDUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBiYXNlQmxvY2tPZmZzZXQ6IC0yNSxcbiAgICAgICAgICAgICAgICAgIHJvbGxiYWNrOiB7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzQmVmb3JlUm9sbGJhY2s6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJvbGxiYWNrQmxvY2tPZmZzZXQ6IC0yMCxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICBjYXNlIENoYWluSWQuQVJCSVRSVU1fT05FOlxuICAgICAgICAgICAgICBxdW90ZVByb3ZpZGVyID0gbmV3IE9uQ2hhaW5RdW90ZVByb3ZpZGVyKFxuICAgICAgICAgICAgICAgIGNoYWluSWQsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgbXVsdGljYWxsMlByb3ZpZGVyLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHJldHJpZXM6IDIsXG4gICAgICAgICAgICAgICAgICBtaW5UaW1lb3V0OiAxMDAsXG4gICAgICAgICAgICAgICAgICBtYXhUaW1lb3V0OiAxMDAwLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgbXVsdGljYWxsQ2h1bms6IDE1LFxuICAgICAgICAgICAgICAgICAgZ2FzTGltaXRQZXJDYWxsOiAxNV8wMDBfMDAwLFxuICAgICAgICAgICAgICAgICAgcXVvdGVNaW5TdWNjZXNzUmF0ZTogMC4xNSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGdhc0xpbWl0T3ZlcnJpZGU6IDMwXzAwMF8wMDAsXG4gICAgICAgICAgICAgICAgICBtdWx0aWNhbGxDaHVuazogOCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGdhc0xpbWl0T3ZlcnJpZGU6IDMwXzAwMF8wMDAsXG4gICAgICAgICAgICAgICAgICBtdWx0aWNhbGxDaHVuazogOCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGJhc2VCbG9ja09mZnNldDogMCxcbiAgICAgICAgICAgICAgICAgIHJvbGxiYWNrOiB7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzQmVmb3JlUm9sbGJhY2s6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJvbGxiYWNrQmxvY2tPZmZzZXQ6IC0xMCxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcG9ydGlvblByb3ZpZGVyID0gbmV3IFBvcnRpb25Qcm92aWRlcigpXG4gICAgICAgICAgY29uc3QgdGVuZGVybHlTaW11bGF0b3IgPSBuZXcgVGVuZGVybHlTaW11bGF0b3IoXG4gICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgJ2h0dHBzOi8vYXBpLnRlbmRlcmx5LmNvJyxcbiAgICAgICAgICAgIHByb2Nlc3MuZW52LlRFTkRFUkxZX1VTRVIhLFxuICAgICAgICAgICAgcHJvY2Vzcy5lbnYuVEVOREVSTFlfUFJPSkVDVCEsXG4gICAgICAgICAgICBwcm9jZXNzLmVudi5URU5ERVJMWV9BQ0NFU1NfS0VZISxcbiAgICAgICAgICAgIHYyUG9vbFByb3ZpZGVyLFxuICAgICAgICAgICAgdjNQb29sUHJvdmlkZXIsXG4gICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgIHBvcnRpb25Qcm92aWRlcixcbiAgICAgICAgICAgIHsgW0NoYWluSWQuQVJCSVRSVU1fT05FXTogMi41IH0sXG4gICAgICAgICAgICAvLyBUaGUgdGltZW91dCBmb3IgdGhlIHVuZGVybHlpbmcgYXhpb3MgY2FsbCB0byBUZW5kZXJseSwgbWVhc3VyZWQgaW4gbWlsbGlzZWNvbmRzLlxuICAgICAgICAgICAgMi41ICogMTAwMFxuICAgICAgICAgIClcblxuICAgICAgICAgIGNvbnN0IGV0aEVzdGltYXRlR2FzU2ltdWxhdG9yID0gbmV3IEV0aEVzdGltYXRlR2FzU2ltdWxhdG9yKFxuICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgIHByb3ZpZGVyLFxuICAgICAgICAgICAgdjJQb29sUHJvdmlkZXIsXG4gICAgICAgICAgICB2M1Bvb2xQcm92aWRlcixcbiAgICAgICAgICAgIHBvcnRpb25Qcm92aWRlclxuICAgICAgICAgIClcblxuICAgICAgICAgIGNvbnN0IHNpbXVsYXRvciA9IG5ldyBGYWxsYmFja1RlbmRlcmx5U2ltdWxhdG9yKFxuICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgIHByb3ZpZGVyLFxuICAgICAgICAgICAgcG9ydGlvblByb3ZpZGVyLFxuICAgICAgICAgICAgdGVuZGVybHlTaW11bGF0b3IsXG4gICAgICAgICAgICBldGhFc3RpbWF0ZUdhc1NpbXVsYXRvclxuICAgICAgICAgIClcblxuICAgICAgICAgIGxldCByb3V0ZUNhY2hpbmdQcm92aWRlcjogSVJvdXRlQ2FjaGluZ1Byb3ZpZGVyIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkXG4gICAgICAgICAgaWYgKENBQ0hFRF9ST1VURVNfVEFCTEVfTkFNRSAmJiBDQUNIRURfUk9VVEVTX1RBQkxFX05BTUUgIT09ICcnKSB7XG4gICAgICAgICAgICByb3V0ZUNhY2hpbmdQcm92aWRlciA9IG5ldyBEeW5hbW9Sb3V0ZUNhY2hpbmdQcm92aWRlcih7XG4gICAgICAgICAgICAgIHJvdXRlc1RhYmxlTmFtZTogUk9VVEVTX1RBQkxFX05BTUUhLFxuICAgICAgICAgICAgICByb3V0ZXNDYWNoaW5nUmVxdWVzdEZsYWdUYWJsZU5hbWU6IFJPVVRFU19DQUNISU5HX1JFUVVFU1RfRkxBR19UQUJMRV9OQU1FISxcbiAgICAgICAgICAgICAgY2FjaGluZ1F1b3RlTGFtYmRhTmFtZTogQVdTX0xBTUJEQV9GVU5DVElPTl9OQU1FISxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYWluSWQsXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IHtcbiAgICAgICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgICAgIHRva2VuTGlzdFByb3ZpZGVyLFxuICAgICAgICAgICAgICBibG9ja2VkVG9rZW5MaXN0UHJvdmlkZXIsXG4gICAgICAgICAgICAgIG11bHRpY2FsbFByb3ZpZGVyOiBtdWx0aWNhbGwyUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHRva2VuUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHRva2VuUHJvdmlkZXJGcm9tVG9rZW5MaXN0OiB0b2tlbkxpc3RQcm92aWRlcixcbiAgICAgICAgICAgICAgZ2FzUHJpY2VQcm92aWRlcjogbmV3IENhY2hpbmdHYXNTdGF0aW9uUHJvdmlkZXIoXG4gICAgICAgICAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgICAgICAgICBuZXcgT25DaGFpbkdhc1ByaWNlUHJvdmlkZXIoXG4gICAgICAgICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgICAgICAgbmV3IEVJUDE1NTlHYXNQcmljZVByb3ZpZGVyKHByb3ZpZGVyKSxcbiAgICAgICAgICAgICAgICAgIG5ldyBMZWdhY3lHYXNQcmljZVByb3ZpZGVyKHByb3ZpZGVyKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgbmV3IE5vZGVKU0NhY2hlKG5ldyBOb2RlQ2FjaGUoeyBzdGRUVEw6IDE1LCB1c2VDbG9uZXM6IGZhbHNlIH0pKVxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICB2M1N1YmdyYXBoUHJvdmlkZXIsXG4gICAgICAgICAgICAgIG9uQ2hhaW5RdW90ZVByb3ZpZGVyOiBxdW90ZVByb3ZpZGVyLFxuICAgICAgICAgICAgICB2M1Bvb2xQcm92aWRlcixcbiAgICAgICAgICAgICAgdjJQb29sUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHYyUXVvdGVQcm92aWRlcjogbmV3IFYyUXVvdGVQcm92aWRlcigpLFxuICAgICAgICAgICAgICB2MlN1YmdyYXBoUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHNpbXVsYXRvcixcbiAgICAgICAgICAgICAgcm91dGVDYWNoaW5nUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHRva2VuVmFsaWRhdG9yUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHRva2VuUHJvcGVydGllc1Byb3ZpZGVyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApXG5cbiAgICAgIGZvciAoY29uc3QgeyBjaGFpbklkLCBkZXBlbmRlbmNpZXMgfSBvZiBkZXBlbmRlbmNpZXNCeUNoYWluQXJyYXkpIHtcbiAgICAgICAgZGVwZW5kZW5jaWVzQnlDaGFpbltjaGFpbklkXSA9IGRlcGVuZGVuY2llc1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkZXBlbmRlbmNpZXM6IGRlcGVuZGVuY2llc0J5Q2hhaW4sXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cuZmF0YWwoeyBlcnIgfSwgYEZhdGFsOiBGYWlsZWQgdG8gYnVpbGQgY29udGFpbmVyYClcbiAgICAgIHRocm93IGVyclxuICAgIH1cbiAgfVxufVxuIl19