import { expect } from 'chai';
import { computePortionAmount, parseDeadline, parseFeeOptions, parseFlatFeeOptions, parsePortionPercent, populateFeeOptions, } from '../../../../lib/handlers/shared';
import { getAmount } from '../../../utils/tokens';
import { CurrencyAmount, Percent } from '@uniswap/sdk-core';
import { DAI_MAINNET, SwapType } from '@uniswap/smart-order-router';
describe('shared', async () => {
    it('parsePortionPercent', () => {
        const percent = parsePortionPercent(10000);
        expect(percent.quotient.toString()).to.equal('1');
    });
    it('parseFeePortions', () => {
        const feeOptions = parseFeeOptions(10000, '0x123');
        expect(feeOptions).not.to.be.undefined;
        if (feeOptions) {
            expect(feeOptions.fee.quotient.toString()).to.equal('1');
            expect(feeOptions.recipient).to.equal('0x123');
        }
    });
    it('parseFlatFeePortions', () => {
        const flatFeeOptionsent = parseFlatFeeOptions('35', '0x123');
        expect(flatFeeOptionsent).not.to.be.undefined;
        if (flatFeeOptionsent) {
            expect(flatFeeOptionsent.amount.toString()).to.equal('35');
            expect(flatFeeOptionsent.recipient).to.equal('0x123');
        }
    });
    it('computePortionAmount', async () => {
        const amount = await getAmount(1, 'EXACT_OUTPUT', 'ETH', 'DAI', '1');
        const daiAmount = CurrencyAmount.fromRawAmount(DAI_MAINNET, amount);
        const portionAmount = computePortionAmount(daiAmount, 15);
        expect(portionAmount).not.to.be.undefined;
        if (portionAmount) {
            expect(portionAmount).to.equal(daiAmount.multiply(parsePortionPercent(15)).quotient.toString());
        }
    });
    it('populateFeeOptions exact in', () => {
        const allFeeOptions = populateFeeOptions('exactIn', 15, '0x123');
        const swapParams = {
            type: SwapType.UNIVERSAL_ROUTER,
            deadlineOrPreviousBlockhash: parseDeadline('1800'),
            recipient: '0x123',
            slippageTolerance: new Percent(5),
            ...allFeeOptions,
        };
        expect(swapParams.fee).not.to.be.undefined;
        expect(swapParams.fee.fee.equalTo(parsePortionPercent(15))).to.be.true;
        expect(swapParams.fee.recipient).to.equal('0x123');
        expect(swapParams.flatFee).to.be.undefined;
    });
    it('populateFeeOptions exact out', () => {
        const allFeeOptions = populateFeeOptions('exactOut', undefined, '0x123', '35');
        const swapParams = {
            type: SwapType.UNIVERSAL_ROUTER,
            deadlineOrPreviousBlockhash: parseDeadline('1800'),
            recipient: '0x123',
            slippageTolerance: new Percent(5),
            ...allFeeOptions,
        };
        expect(swapParams.flatFee).not.to.be.undefined;
        expect(swapParams.flatFee.amount.toString()).to.equal('35');
        expect(swapParams.flatFee.recipient).to.equal('0x123');
        expect(swapParams.fee).to.be.undefined;
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmVkLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi90ZXN0L21vY2hhL3VuaXQvaGFuZGxlcnMvc2hhcmVkLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUM3QixPQUFPLEVBQ0wsb0JBQW9CLEVBQ3BCLGFBQWEsRUFDYixlQUFlLEVBQ2YsbUJBQW1CLEVBQ25CLG1CQUFtQixFQUNuQixrQkFBa0IsR0FDbkIsTUFBTSxpQ0FBaUMsQ0FBQTtBQUN4QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sdUJBQXVCLENBQUE7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxPQUFPLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQTtBQUMzRCxPQUFPLEVBQUUsV0FBVyxFQUFlLFFBQVEsRUFBRSxNQUFNLDZCQUE2QixDQUFBO0FBRWhGLFFBQVEsQ0FBQyxRQUFRLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDNUIsRUFBRSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtRQUM3QixNQUFNLE9BQU8sR0FBRyxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUMxQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDbkQsQ0FBQyxDQUFDLENBQUE7SUFFRixFQUFFLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQzFCLE1BQU0sVUFBVSxHQUFHLGVBQWUsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFDbEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQTtRQUV0QyxJQUFJLFVBQVUsRUFBRTtZQUNkLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFFB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QUMsVUFBVSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFFOUUsTUFBTSxVQUFVLEdBQWdCO1lBQzlCLElBQUksRUFBRSxRQUFRLENBQUMsZ0JBQWdCO1lBQy9CLDJCQUEyQixFQUFFLGFBQWEsQ0FBQyxNQUFNLENBQUM7WUFDbEQsU0FBUyxFQUFFLE9BQU87WUFDbEIsaUJBQWlCLEVBQUUsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ2pDLEdBQUcsYUFBYTtTQUNqQixDQUFBO1FBRUQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUE7UUFDOUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFRLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUM1RCxNQUFNLENBQUMsVUFBVSxDQUFDLE9BQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBRXZELE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUE7SUFDeEMsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknXG5pbXBvcnQge1xuICBjb21wdXRlUG9ydGlvbkFtb3VudCxcbiAgcGFyc2VEZWFkbGluZSxcbiAgcGFyc2VGZWVPcHRpb25zLFxuICBwYXJzZUZsYXRGZWVPcHRpb25zLFxuICBwYXJzZVBvcnRpb25QZXJjZW50LFxuICBwb3B1bGF0ZUZlZU9wdGlvbnMsXG59IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9oYW5kbGVycy9zaGFyZWQnXG5pbXBvcnQgeyBnZXRBbW91bnQgfSBmcm9tICcuLi8uLi8uLi91dGlscy90b2tlbnMnXG5pbXBvcnQgeyBDdXJyZW5jeUFtb3VudCwgUGVyY2VudCB9IGZyb20gJ0B1bmlzd2FwL3Nkay1jb3JlJ1xuaW1wb3J0IHsgREFJX01BSU5ORVQsIFN3YXBPcHRpb25zLCBTd2FwVHlwZSB9IGZyb20gJ0B1bmlzd2FwL3NtYXJ0LW9yZGVyLXJvdXRlcidcblxuZGVzY3JpYmUoJ3NoYXJlZCcsIGFzeW5jICgpID0+IHtcbiAgaXQoJ3BhcnNlUG9ydGlvblBlcmNlbnQnLCAoKSA9PiB7XG4gICAgY29uc3QgcGVyY2VudCA9IHBhcnNlUG9ydGlvblBlcmNlbnQoMTAwMDApXG4gICAgZXhwZWN0KHBlcmNlbnQucXVvdGllbnQudG9TdHJpbmcoKSkudG8uZXF1YWwoJzEnKVxuICB9KVxuXG4gIGl0KCdwYXJzZUZlZVBvcnRpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGZlZU9wdGlvbnMgPSBwYXJzZUZlZU9wdGlvbnMoMTAwMDAsICcweDEyMycpXG4gICAgZXhwZWN0KGZlZU9wdGlvbnMpLm5vdC50by5iZS51bmRlZmluZWRcblxuICAgIGlmIChmZWVPcHRpb25zKSB7XG4gICAgICBleHBlY3QoZmVlT3B0aW9ucy5mZWUucXVvdGllbnQudG9TdHJpbmcoKSkudG8uZXF1YWwoJzEnKVxuICAgICAgZXhwZWN0KGZlZU9wdGlvbnMucmVjaXBpZW50KS50by5lcXVhbCgnMHgxMjMnKVxuICAgIH1cbiAgfSlcblxuICBpdCgncGFyc2VGbGF0RmVlUG9ydGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgZmxhdEZlZU9wdGlvbnNlbnQgPSBwYXJzZUZsYXRGZWVPcHRpb25zKCczNScsICcweDEyMycpXG4gICAgZXhwZWN0KGZsYXRGZWVPcHRpb25zZW50KS5ub3QudG8uYmUudW5kZWZpbmVkXG5cbiAgICBpZiAoZmxhdEZlZU9wdGlvbnNlbnQpIHtcbiAgICAgIGV4cGVjdChmbGF0RmVlT3B0aW9uc2VudC5hbW91bnQudG9TdHJpbmcoKSkudG8uZXF1YWwoJzM1JylcbiAgICAgIGV4cGVjdChmbGF0RmVlT3B0aW9uc2VudC5yZWNpcGllbnQpLnRvLmVxdWFsKCcweDEyMycpXG4gICAgfVxuICB9KVxuXG4gIGl0KCdjb21wdXRlUG9ydGlvbkFtb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBhbW91bnQgPSBhd2FpdCBnZXRBbW91bnQoMSwgJ0VYQUNUX09VVFBVVCcsICdFVEgnLCAnREFJJywgJzEnKVxuICAgIGNvbnN0IGRhaUFtb3VudCA9IEN1cnJlbmN5QW1vdW50LmZyb21SYXdBbW91bnQoREFJX01BSU5ORVQsIGFtb3VudClcbiAgICBjb25zdCBwb3J0aW9uQW1vdW50ID0gY29tcHV0ZVBvcnRpb25BbW91bnQoZGFpQW1vdW50LCAxNSlcbiAgICBleHBlY3QocG9ydGlvbkFtb3VudCkubm90LnRvLmJlLnVuZGVmaW5lZFxuXG4gICAgaWYgKHBvcnRpb25BbW91bnQpIHtcbiAgICAgIGV4cGVjdChwb3J0aW9uQW1vdW50KS50by5lcXVhbChkYWlBbW91bnQubXVsdGlwbHkocGFyc2VQb3J0aW9uUGVyY2VudCgxNSkpLnF1b3RpZW50LnRvU3RyaW5nKCkpXG4gICAgfVxuICB9KVxuXG4gIGl0KCdwb3B1bGF0ZUZlZU9wdGlvbnMgZXhhY3QgaW4nLCAoKSA9PiB7XG4gICAgY29uc3QgYWxsRmVlT3B0aW9ucyA9IHBvcHVsYXRlRmVlT3B0aW9ucygnZXhhY3RJbicsIDE1LCAnMHgxMjMnKVxuXG4gICAgY29uc3Qgc3dhcFBhcmFtczogU3dhcE9wdGlvbnMgPSB7XG4gICAgICB0eXBlOiBTd2FwVHlwZS5VTklWRVJTQUxfUk9VVEVSLFxuICAgICAgZGVhZGxpbmVPclByZXZpb3VzQmxvY2toYXNoOiBwYXJzZURlYWRsaW5lKCcxODAwJyksXG4gICAgICByZWNpcGllbnQ6ICcweDEyMycsXG4gICAgICBzbGlwcGFnZVRvbGVyYW5jZTogbmV3IFBlcmNlbnQoNSksXG4gICAgICAuLi5hbGxGZWVPcHRpb25zLFxuICAgIH1cblxuICAgIGV4cGVjdChzd2FwUGFyYW1zLmZlZSkubm90LnRvLmJlLnVuZGVmaW5lZFxuICAgIGV4cGVjdChzd2FwUGFyYW1zLmZlZSEuZmVlLmVxdWFsVG8ocGFyc2VQb3J0aW9uUGVyY2VudCgxNSkpKS50by5iZS50cnVlXG4gICAgZXhwZWN0KHN3YXBQYXJhbXMuZmVlIS5yZWNpcGllbnQpLnRvLmVxdWFsKCcweDEyMycpXG5cbiAgICBleHBlY3Qoc3dhcFBhcmFtcy5mbGF0RmVlKS50by5iZS51bmRlZmluZWRcbiAgfSlcblxuICBpdCgncG9wdWxhdGVGZWVPcHRpb25zIGV4YWN0IG91dCcsICgpID0+IHtcbiAgICBjb25zdCBhbGxGZWVPcHRpb25zID0gcG9wdWxhdGVGZWVPcHRpb25zKCdleGFjdE91dCcsIHVuZGVmaW5lZCwgJzB4MTIzJywgJzM1JylcblxuICAgIGNvbnN0IHN3YXBQYXJhbXM6IFN3YXBPcHRpb25zID0ge1xuICAgICAgdHlwZTogU3dhcFR5cGUuVU5JVkVSU0FMX1JPVVRFUixcbiAgICAgIGRlYWRsaW5lT3JQcmV2aW91c0Jsb2NraGFzaDogcGFyc2VEZWFkbGluZSgnMTgwMCcpLFxuICAgICAgcmVjaXBpZW50OiAnMHgxMjMnLFxuICAgICAgc2xpcHBhZ2VUb2xlcmFuY2U6IG5ldyBQZXJjZW50KDUpLFxuICAgICAgLi4uYWxsRmVlT3B0aW9ucyxcbiAgICB9XG5cbiAgICBleHBlY3Qoc3dhcFBhcmFtcy5mbGF0RmVlKS5ub3QudG8uYmUudW5kZWZpbmVkXG4gICAgZXhwZWN0KHN3YXBQYXJhbXMuZmxhdEZlZSEuYW1vdW50LnRvU3RyaW5nKCkpLnRvLmVxdWFsKCczNScpXG4gICAgZXhwZWN0KHN3YXBQYXJhbXMuZmxhdEZlZSEucmVjaXBpZW50KS50by5lcXVhbCgnMHgxMjMnKVxuXG4gICAgZXhwZWN0KHN3YXBQYXJhbXMuZmVlKS50by5iZS51bmRlZmluZWRcbiAgfSlcbn0pXG4iXX0=