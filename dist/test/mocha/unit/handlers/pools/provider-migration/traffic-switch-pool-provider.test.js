import { TrafficSwitchV3PoolProvider } from '../../../../../../lib/handlers/pools/provider-migration/v3/traffic-switch-v3-pool-provider';
import { DynamoDBCachingV3PoolProvider } from '../../../../../../lib/handlers/pools/pool-caching/v3/dynamo-caching-pool-provider';
import { getMockedV3PoolProvider, TEST_ROUTE_TABLE } from '../../../../../test-utils/mocked-dependencies';
import { CachingV3PoolProvider, MetricLoggerUnit, NodeJSCache } from '@uniswap/smart-order-router';
import NodeCache from 'node-cache';
import sinon from 'sinon';
import { ChainId } from '@uniswap/sdk-core';
import { encodeSqrtRatioX96, FeeAmount, Pool } from '@uniswap/v3-sdk';
import { DAI_USDT_LOW, SUPPORTED_POOLS, USDC_DAI_MEDIUM, USDC_WETH_LOW, WETH9_USDT_LOW, } from '../../../../../test-utils/mocked-data';
import { metric } from '@uniswap/smart-order-router/build/main/util/metric';
import { setupTables } from '../../../../dbSetup';
import { DAI_MAINNET as DAI, USDC_MAINNET as USDC, } from '@uniswap/smart-order-router/build/main/providers/token-provider';
describe('TrafficSwitchV3PoolProvider', async () => {
    setupTables(TEST_ROUTE_TABLE);
    const spy = sinon.spy(metric, 'putMetric');
    it('switch traffic and sample pools with accurate pricing and liquidity', async () => {
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_QUOTE_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_LIQUIDITY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_ACCURACY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_QUOTE_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_LIQUIDITY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_ACCURACY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TRAFFIC_SAMPLING', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TRAFFIC_TOTAL', 1, MetricLoggerUnit.None);
        const underlyingPool = getMockedV3PoolProvider();
        const inMemoryPoolCache = new CachingV3PoolProvider(ChainId.GOERLI, underlyingPool, new NodeJSCache(new NodeCache({ stdTTL: 15, useClones: false })));
        const dynamoPoolCache = new DynamoDBCachingV3PoolProvider(ChainId.GOERLI, underlyingPool, TEST_ROUTE_TABLE.TableName);
        const trafficSwitchProvider = new (class SwitchTrafficSwitchV3PoolProvider extends TrafficSwitchV3PoolProvider {
            constructor() {
                super(...arguments);
                this.SHOULD_SWITCH_TRAFFIC = () => true;
                this.SHOULD_SAMPLE_TRAFFIC = () => true;
            }
        })({
            currentPoolProvider: inMemoryPoolCache,
            targetPoolProvider: dynamoPoolCache,
            sourceOfTruthPoolProvider: underlyingPool,
        });
        const tokenPairs = SUPPORTED_POOLS.map((pool) => {
            return [pool.token0, pool.token1, pool.fee];
        });
        const providerConfig = { blockNumber: 111 };
        await trafficSwitchProvider.getPools(tokenPairs, providerConfig);
        sinon.assert.called(spy);
    });
    it('not switch traffic and sample pools with inaccurate pricing and inaccurate liquidity', async () => {
        const USDC_DAI_LOW_INACCURATE = new Pool(USDC, DAI, FeeAmount.LOW, encodeSqrtRatioX96(2, 2), 9, 0);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_QUOTE_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_LIQUIDITY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_ACCURACY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_QUOTE_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_LIQUIDITY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_ACCURACY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TRAFFIC_TOTAL', 1, MetricLoggerUnit.None);
        const underlyingPool = getMockedV3PoolProvider([
            USDC_DAI_LOW_INACCURATE,
            USDC_DAI_MEDIUM,
            USDC_WETH_LOW,
            WETH9_USDT_LOW,
            DAI_USDT_LOW,
        ]);
        const inMemoryPoolCache = new CachingV3PoolProvider(ChainId.GOERLI, underlyingPool, new NodeJSCache(new NodeCache({ stdTTL: 15, useClones: false })));
        const dynamoPoolCache = new DynamoDBCachingV3PoolProvider(ChainId.GOERLI, underlyingPool, TEST_ROUTE_TABLE.TableName);
        const trafficSwitchProvider = new (class SwitchTrafficSwitchV3PoolProvider extends TrafficSwitchV3PoolProvider {
            constructor() {
                super(...arguments);
                this.SHOULD_SWITCH_TRAFFIC = () => false;
                this.SHOULD_SAMPLE_TRAFFIC = () => true;
            }
        })({
            currentPoolProvider: inMemoryPoolCache,
            targetPoolProvider: dynamoPoolCache,
            sourceOfTruthPoolProvider: underlyingPool,
        });
        const tokenPairs = SUPPORTED_POOLS.map((pool) => {
            return [pool.token0, pool.token1, pool.fee];
        });
        const providerConfig = { blockNumber: 111 };
        await trafficSwitchProvider.getPools(tokenPairs, providerConfig);
        sinon.assert.called(spy);
    });
    it('not switch traffic and sample pools with inaccurate pricing but accurate liquidity', async () => {
        const USDC_DAI_LOW_INACCURATE = new Pool(USDC, DAI, FeeAmount.LOW, encodeSqrtRatioX96(2, 2), 10, 0);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_QUOTE_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_LIQUIDITY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_CURRENT_ACCURACY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_QUOTE_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_LIQUIDITY_MATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TARGET_ACCURACY_MISMATCH', 1, MetricLoggerUnit.None);
        spy.withArgs('V3_POOL_PROVIDER_POOL_TRAFFIC_TOTAL', 1, MetricLoggerUnit.None);
        const underlyingPool = getMockedV3PoolProvider([
            USDC_DAI_LOW_INACCURATE,
            USDC_DAI_MEDIUM,
            USDC_WETH_LOW,
            WETH9_USDT_LOW,
            DAI_USDT_LOW,
        ]);
        const inMemoryPoolCache = new CachingV3PoolProvider(ChainId.GOERLI, underlyingPool, new NodeJSCache(new NodeCache({ stdTTL: 15, useClones: false })));
        const dynamoPoolCache = new DynamoDBCachingV3PoolProvider(ChainId.GOERLI, underlyingPool, TEST_ROUTE_TABLE.TableName);
        const trafficSwitchProvider = new (class SwitchTrafficSwitchV3PoolProvider extends TrafficSwitchV3PoolProvider {
            constructor() {
                super(...arguments);
                this.SHOULD_SWITCH_TRAFFIC = () => false;
                this.SHOULD_SAMPLE_TRAFFIC = () => true;
            }
        })({
            currentPoolProvider: inMemoryPoolCache,
            targetPoolProvider: dynamoPoolCache,
            sourceOfTruthPoolProvider: underlyingPool,
        });
        const tokenPairs = SUPPORTED_POOLS.map((pool) => {
            return [pool.token0, pool.token1, pool.fee];
        });
        const providerConfig = { blockNumber: 111 };
        await trafficSwitchProvider.getPools(tokenPairs, providerConfig);
        sinon.assert.called(spy);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhZmZpYy1zd2l0Y2gtcG9vbC1wcm92aWRlci50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vdGVzdC9tb2NoYS91bml0L2hhbmRsZXJzL3Bvb2xzL3Byb3ZpZGVyLW1pZ3JhdGlvbi90cmFmZmljLXN3aXRjaC1wb29sLXByb3ZpZGVyLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sNEZBQTRGLENBQUE7QUFDeEksT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sbUZBQW1GLENBQUE7QUFDakksT0FBTyxFQUFFLHVCQUF1QixFQUFFLGdCQUFnQixFQUFFLE1BQU0sK0NBQStDLENBQUE7QUFDekcsT0FBTyxFQUFFLHFCQUFxQixFQUFFLGdCQUFnQixFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFBO0FBQ2xHLE9BQU8sU0FBUyxNQUFNLFlBQVksQ0FBQTtBQUNsQyxPQUFPLEtBQUssTUFBTSxPQUFPLENBQUE7QUFDekIsT0FBTyxFQUFFLE9BQU8sRUFBUyxNQUFNLG1CQUFtQixDQUFBO0FBQ2xELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUE7QUFDckUsT0FBTyxFQUNMLFlBQVksRUFDWixlQUFlLEVBQ2YsZUFBZSxFQUNmLGFBQWEsRUFDYixjQUFjLEdBQ2YsTUFBTSx1Q0FBdUMsQ0FBQTtBQUU5QyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sb0RBQW9ELENBQUE7QUFDM0UsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFBO0FBQ2pELE9BQU8sRUFDTCxXQUFXLElBQUksR0FBRyxFQUNsQixZQUFZLElBQUksSUFBSSxHQUNyQixNQUFNLGlFQUFpRSxDQUFBO0FBRXhFLFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxLQUFLLElBQUksRUFBRTtJQUNqRCxXQUFX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MEJBQXFCLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFBO1lBQ3RELENBQUM7U0FBQSxDQUFDLENBQUM7WUFDRCxtQkFBbUIsRUFBRSxpQkFBaUI7WUFDdEMsa0JBQWtCLEVBQUUsZUFBZTtZQUNuQyx5QkFBeUIsRUFBRSxjQUFjO1NBQzFDLENBQUMsQ0FBQTtRQUVGLE1BQU0sVUFBVSxHQUFnQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBVSxFQUFFLEVBQUU7WUFDakYsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDN0MsQ0FBQyxDQUFDLENBQUE7UUFDRixNQUFNLGNBQWMsR0FBbUIsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUE7UUFDM0QsTUFBTSxxQkFBcUIsQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLGNBQWMsQ0FBQyxDQUFBO1FBRWhFLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQzFCLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFmZmljU3dpdGNoVjNQb29sUHJvdmlkZXIgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi8uLi9saWIvaGFuZGxlcnMvcG9vbHMvcHJvdmlkZXItbWlncmF0aW9uL3YzL3RyYWZmaWMtc3dpdGNoLXYzLXBvb2wtcHJvdmlkZXInXG5pbXBvcnQgeyBEeW5hbW9EQkNhY2hpbmdWM1Bvb2xQcm92aWRlciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uLy4uL2xpYi9oYW5kbGVycy9wb29scy9wb29sLWNhY2hpbmcvdjMvZHluYW1vLWNhY2hpbmctcG9vbC1wcm92aWRlcidcbmltcG9ydCB7IGdldE1vY2tlZFYzUG9vbFByb3ZpZGVyLCBURVNUX1JPVVRFX1RBQkxFIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vdGVzdC11dGlscy9tb2NrZWQtZGVwZW5kZW5jaWVzJ1xuaW1wb3J0IHsgQ2FjaGluZ1YzUG9vbFByb3ZpZGVyLCBNZXRyaWNMb2dnZXJVbml0LCBOb2RlSlNDYWNoZSB9IGZyb20gJ0B1bmlzd2FwL3NtYXJ0LW9yZGVyLXJvdXRlcidcbmltcG9ydCBOb2RlQ2FjaGUgZnJvbSAnbm9kZS1jYWNoZSdcbmltcG9ydCBzaW5vbiBmcm9tICdzaW5vbidcbmltcG9ydCB7IENoYWluSWQsIFRva2VuIH0gZnJvbSAnQHVuaXN3YXAvc2RrLWNvcmUnXG5pbXBvcnQgeyBlbmNvZGVTcXJ0UmF0aW9YOTYsIEZlZUFtb3VudCwgUG9vbCB9IGZyb20gJ0B1bmlzd2FwL3YzLXNkaydcbmltcG9ydCB7XG4gIERBSV9VU0RUX0xPVyxcbiAgU1VQUE9SVEVEX1BPT0xTLFxuICBVU0RDX0RBSV9NRURJVU0sXG4gIFVTRENfV0VUSF9MT1csXG4gIFdFVEg5X1VTRFRfTE9XLFxufSBmcm9tICcuLi8uLi8uLi8uLi8uLi90ZXN0LXV0aWxzL21vY2tlZC1kYXRhJ1xuaW1wb3J0IHsgUHJvdmlkZXJDb25maWcgfSBmcm9tICdAdW5pc3dhcC9zbWFydC1vcmRlci1yb3V0ZXIvYnVpbGQvbWFpbi9wcm92aWRlcnMvcHJvdmlkZXInXG5pbXBvcnQgeyBtZXRyaWMgfSBmcm9tICdAdW5pc3dhcC9zbWFydC1vcmRlci1yb3V0ZXIvYnVpbGQvbWFpbi91dGlsL21ldHJpYydcbmltcG9ydCB7IHNldHVwVGFibGVzIH0gZnJvbSAnLi4vLi4vLi4vLi4vZGJTZXR1cCdcbmltcG9ydCB7XG4gIERBSV9NQUlOTkVUIGFzIERBSSxcbiAgVVNEQ19NQUlOTkVUIGFzIFVTREMsXG59IGZyb20gJ0B1bmlzd2FwL3NtYXJ0LW9yZGVyLXJvdXRlci9idWlsZC9tYWluL3Byb3ZpZGVycy90b2tlbi1wcm92aWRlcidcblxuZGVzY3JpYmUoJ1RyYWZmaWNTd2l0Y2hWM1Bvb2xQcm92aWRlcicsIGFzeW5jICgpID0+IHtcbiAgc2V0dXBUYWJsZXMoVEVTVF9ST1VURV9UQUJMRSlcbiAgY29uc3Qgc3B5ID0gc2lub24uc3B5KG1ldHJpYywgJ3B1dE1ldHJpYycpXG5cbiAgaXQoJ3N3aXRjaCB0cmFmZmljIGFuZCBzYW1wbGUgcG9vbHMgd2l0aCBhY2N1cmF0ZSBwcmljaW5nIGFuZCBsaXF1aWRpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgc3B5LndpdGhBcmdzKCdWM19QT09MX1BST1ZJREVSX1BPT0xfQ1VSUkVOVF9RVU9URV9NQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9DVVJSRU5UX0xJUVVJRElUWV9NQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9DVVJSRU5UX0FDQ1VSQUNZX01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RBUkdFVF9RVU9URV9NQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9UQVJHRVRfTElRVUlESVRZX01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RBUkdFVF9BQ0NVUkFDWV9NQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9UUkFGRklDX1NBTVBMSU5HJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RSQUZGSUNfVE9UQUwnLCAxLCBNZXRyaWNMb2dnZXJVbml0Lk5vbmUpXG5cbiAgICBjb25zdCB1bmRlcmx5aW5nUG9vbCA9IGdldE1vY2tlZFYzUG9vbFByb3ZpZGVyKClcbiAgICBjb25zdCBpbk1lbW9yeVBvb2xDYWNoZSA9IG5ldyBDYWNoaW5nVjNQb29sUHJvdmlkZXIoXG4gICAgICBDaGFpbklkLkdPRVJMSSxcbiAgICAgIHVuZGVybHlpbmdQb29sLFxuICAgICAgbmV3IE5vZGVKU0NhY2hlKG5ldyBOb2RlQ2FjaGUoeyBzdGRUVEw6IDE1LCB1c2VDbG9uZXM6IGZhbHNlIH0pKVxuICAgIClcbiAgICBjb25zdCBkeW5hbW9Qb29sQ2FjaGUgPSBuZXcgRHluYW1vREJDYWNoaW5nVjNQb29sUHJvdmlkZXIoXG4gICAgICBDaGFpbklkLkdPRVJMSSxcbiAgICAgIHVuZGVybHlpbmdQb29sLFxuICAgICAgVEVTVF9ST1VURV9UQUJMRS5UYWJsZU5hbWVcbiAgICApXG4gICAgY29uc3QgdHJhZmZpY1N3aXRjaFByb3ZpZGVyID0gbmV3IChjbGFzcyBTd2l0Y2hUcmFmZmljU3dpdGNoVjNQb29sUHJvdmlkZXIgZXh0ZW5kcyBUcmFmZmljU3dpdGNoVjNQb29sUHJvdmlkZXIge1xuICAgICAgb3ZlcnJpZGUgcmVhZG9ubHkgU0hPVUxEX1NXSVRDSF9UUkFGRklDID0gKCkgPT4gdHJ1ZVxuICAgICAgb3ZlcnJpZGUgcmVhZG9ubHkgU0hPVUxEX1NBTVBMRV9UUkFGRklDID0gKCkgPT4gdHJ1ZVxuICAgIH0pKHtcbiAgICAgIGN1cnJlbnRQb29sUHJvdmlkZXI6IGluTWVtb3J5UG9vbENhY2hlLFxuICAgICAgdGFyZ2V0UG9vbFByb3ZpZGVyOiBkeW5hbW9Qb29sQ2FjaGUsXG4gICAgICBzb3VyY2VPZlRydXRoUG9vbFByb3ZpZGVyOiB1bmRlcmx5aW5nUG9vbCxcbiAgICB9KVxuXG4gICAgY29uc3QgdG9rZW5QYWlyczogW1Rva2VuLCBUb2tlbiwgRmVlQW1vdW50XVtdID0gU1VQUE9SVEVEX1BPT0xTLm1hcCgocG9vbDogUG9vbCkgPT4ge1xuICAgICAgcmV0dXJuIFtwb29sLnRva2VuMCwgcG9vbC50b2tlbjEsIHBvb2wuZmVlXVxuICAgIH0pXG4gICAgY29uc3QgcHJvdmlkZXJDb25maWc6IFByb3ZpZGVyQ29uZmlnID0geyBibG9ja051bWJlcjogMTExIH1cbiAgICBhd2FpdCB0cmFmZmljU3dpdGNoUHJvdmlkZXIuZ2V0UG9vbHModG9rZW5QYWlycywgcHJvdmlkZXJDb25maWcpXG5cbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkKHNweSlcbiAgfSlcblxuICBpdCgnbm90IHN3aXRjaCB0cmFmZmljIGFuZCBzYW1wbGUgcG9vbHMgd2l0aCBpbmFjY3VyYXRlIHByaWNpbmcgYW5kIGluYWNjdXJhdGUgbGlxdWlkaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IFVTRENfREFJX0xPV19JTkFDQ1VSQVRFID0gbmV3IFBvb2woVVNEQywgREFJLCBGZWVBbW91bnQuTE9XLCBlbmNvZGVTcXJ0UmF0aW9YOTYoMiwgMiksIDksIDApXG5cbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9DVVJSRU5UX1FVT1RFX01JU01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX0NVUlJFTlRfTElRVUlESVRZX01JU01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX0NVUlJFTlRfQUNDVVJBQ1lfTUlTTUFUQ0gnLCAxLCBNZXRyaWNMb2dnZXJVbml0Lk5vbmUpXG4gICAgc3B5LndpdGhBcmdzKCdWM19QT09MX1BST1ZJREVSX1BPT0xfVEFSR0VUX1FVT1RFX01JU01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RBUkdFVF9MSVFVSURJVFlfTUlTTUFUQ0gnLCAxLCBNZXRyaWNMb2dnZXJVbml0Lk5vbmUpXG4gICAgc3B5LndpdGhBcmdzKCdWM19QT09MX1BST1ZJREVSX1BPT0xfVEFSR0VUX0FDQ1VSQUNZX01JU01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RSQUZGSUNfVE9UQUwnLCAxLCBNZXRyaWNMb2dnZXJVbml0Lk5vbmUpXG5cbiAgICBjb25zdCB1bmRlcmx5aW5nUG9vbCA9IGdldE1vY2tlZFYzUG9vbFByb3ZpZGVyKFtcbiAgICAgIFVTRENfREFJX0xPV19JTkFDQ1VSQVRFLFxuICAgICAgVVNEQ19EQUlfTUVESVVNLFxuICAgICAgVVNEQ19XRVRIX0xPVyxcbiAgICAgIFdFVEg5X1VTRFRfTE9XLFxuICAgICAgREFJX1VTRFRfTE9XLFxuICAgIF0pXG4gICAgY29uc3QgaW5NZW1vcnlQb29sQ2FjaGUgPSBuZXcgQ2FjaGluZ1YzUG9vbFByb3ZpZGVyKFxuICAgICAgQ2hhaW5JZC5HT0VSTEksXG4gICAgICB1bmRlcmx5aW5nUG9vbCxcbiAgICAgIG5ldyBOb2RlSlNDYWNoZShuZXcgTm9kZUNhY2hlKHsgc3RkVFRMOiAxNSwgdXNlQ2xvbmVzOiBmYWxzZSB9KSlcbiAgICApXG4gICAgY29uc3QgZHluYW1vUG9vbENhY2hlID0gbmV3IER5bmFtb0RCQ2FjaGluZ1YzUG9vbFByb3ZpZGVyKFxuICAgICAgQ2hhaW5JZC5HT0VSTEksXG4gICAgICB1bmRlcmx5aW5nUG9vbCxcbiAgICAgIFRFU1RfUk9VVEVfVEFCTEUuVGFibGVOYW1lXG4gICAgKVxuICAgIGNvbnN0IHRyYWZmaWNTd2l0Y2hQcm92aWRlciA9IG5ldyAoY2xhc3MgU3dpdGNoVHJhZmZpY1N3aXRjaFYzUG9vbFByb3ZpZGVyIGV4dGVuZHMgVHJhZmZpY1N3aXRjaFYzUG9vbFByb3ZpZGVyIHtcbiAgICAgIG92ZXJyaWRlIHJlYWRvbmx5IFNIT1VMRF9TV0lUQ0hfVFJBRkZJQyA9ICgpID0+IGZhbHNlXG4gICAgICBvdmVycmlkZSByZWFkb25seSBTSE9VTERfU0FNUExFX1RSQUZGSUMgPSAoKSA9PiB0cnVlXG4gICAgfSkoe1xuICAgICAgY3VycmVudFBvb2xQcm92aWRlcjogaW5NZW1vcnlQb29sQ2FjaGUsXG4gICAgICB0YXJnZXRQb29sUHJvdmlkZXI6IGR5bmFtb1Bvb2xDYWNoZSxcbiAgICAgIHNvdXJjZU9mVHJ1dGhQb29sUHJvdmlkZXI6IHVuZGVybHlpbmdQb29sLFxuICAgIH0pXG5cbiAgICBjb25zdCB0b2tlblBhaXJzOiBbVG9rZW4sIFRva2VuLCBGZWVBbW91bnRdW10gPSBTVVBQT1JURURfUE9PTFMubWFwKChwb29sOiBQb29sKSA9PiB7XG4gICAgICByZXR1cm4gW3Bvb2wudG9rZW4wLCBwb29sLnRva2VuMSwgcG9vbC5mZWVdXG4gICAgfSlcbiAgICBjb25zdCBwcm92aWRlckNvbmZpZzogUHJvdmlkZXJDb25maWcgPSB7IGJsb2NrTnVtYmVyOiAxMTEgfVxuICAgIGF3YWl0IHRyYWZmaWNTd2l0Y2hQcm92aWRlci5nZXRQb29scyh0b2tlblBhaXJzLCBwcm92aWRlckNvbmZpZylcblxuICAgIHNpbm9uLmFzc2VydC5jYWxsZWQoc3B5KVxuICB9KVxuXG4gIGl0KCdub3Qgc3dpdGNoIHRyYWZmaWMgYW5kIHNhbXBsZSBwb29scyB3aXRoIGluYWNjdXJhdGUgcHJpY2luZyBidXQgYWNjdXJhdGUgbGlxdWlkaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IFVTRENfREFJX0xPV19JTkFDQ1VSQVRFID0gbmV3IFBvb2woVVNEQywgREFJLCBGZWVBbW91bnQuTE9XLCBlbmNvZGVTcXJ0UmF0aW9YOTYoMiwgMiksIDEwLCAwKVxuXG4gICAgc3B5LndpdGhBcmdzKCdWM19QT09MX1BST1ZJREVSX1BPT0xfQ1VSUkVOVF9RVU9URV9NSVNNQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9DVVJSRU5UX0xJUVVJRElUWV9NQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9DVVJSRU5UX0FDQ1VSQUNZX01JU01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RBUkdFVF9RVU9URV9NSVNNQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9UQVJHRVRfTElRVUlESVRZX01BVENIJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuICAgIHNweS53aXRoQXJncygnVjNfUE9PTF9QUk9WSURFUl9QT09MX1RBUkdFVF9BQ0NVUkFDWV9NSVNNQVRDSCcsIDEsIE1ldHJpY0xvZ2dlclVuaXQuTm9uZSlcbiAgICBzcHkud2l0aEFyZ3MoJ1YzX1BPT0xfUFJPVklERVJfUE9PTF9UUkFGRklDX1RPVEFMJywgMSwgTWV0cmljTG9nZ2VyVW5pdC5Ob25lKVxuXG4gICAgY29uc3QgdW5kZXJseWluZ1Bvb2wgPSBnZXRNb2NrZWRWM1Bvb2xQcm92aWRlcihbXG4gICAgICBVU0RDX0RBSV9MT1dfSU5BQ0NVUkFURSxcbiAgICAgIFVTRENfREFJX01FRElVTSxcbiAgICAgIFVTRENfV0VUSF9MT1csXG4gICAgICBXRVRIOV9VU0RUX0xPVyxcbiAgICAgIERBSV9VU0RUX0xPVyxcbiAgICBdKVxuICAgIGNvbnN0IGluTWVtb3J5UG9vbENhY2hlID0gbmV3IENhY2hpbmdWM1Bvb2xQcm92aWRlcihcbiAgICAgIENoYWluSWQuR09FUkxJLFxuICAgICAgdW5kZXJseWluZ1Bvb2wsXG4gICAgICBuZXcgTm9kZUpTQ2FjaGUobmV3IE5vZGVDYWNoZSh7IHN0ZFRUTDogMTUsIHVzZUNsb25lczogZmFsc2UgfSkpXG4gICAgKVxuICAgIGNvbnN0IGR5bmFtb1Bvb2xDYWNoZSA9IG5ldyBEeW5hbW9EQkNhY2hpbmdWM1Bvb2xQcm92aWRlcihcbiAgICAgIENoYWluSWQuR09FUkxJLFxuICAgICAgdW5kZXJseWluZ1Bvb2wsXG4gICAgICBURVNUX1JPVVRFX1RBQkxFLlRhYmxlTmFtZVxuICAgIClcbiAgICBjb25zdCB0cmFmZmljU3dpdGNoUHJvdmlkZXIgPSBuZXcgKGNsYXNzIFN3aXRjaFRyYWZmaWNTd2l0Y2hWM1Bvb2xQcm92aWRlciBleHRlbmRzIFRyYWZmaWNTd2l0Y2hWM1Bvb2xQcm92aWRlciB7XG4gICAgICBvdmVycmlkZSByZWFkb25seSBTSE9VTERfU1dJVENIX1RSQUZGSUMgPSAoKSA9PiBmYWxzZVxuICAgICAgb3ZlcnJpZGUgcmVhZG9ubHkgU0hPVUxEX1NBTVBMRV9UUkFGRklDID0gKCkgPT4gdHJ1ZVxuICAgIH0pKHtcbiAgICAgIGN1cnJlbnRQb29sUHJvdmlkZXI6IGluTWVtb3J5UG9vbENhY2hlLFxuICAgICAgdGFyZ2V0UG9vbFByb3ZpZGVyOiBkeW5hbW9Qb29sQ2FjaGUsXG4gICAgICBzb3VyY2VPZlRydXRoUG9vbFByb3ZpZGVyOiB1bmRlcmx5aW5nUG9vbCxcbiAgICB9KVxuXG4gICAgY29uc3QgdG9rZW5QYWlyczogW1Rva2VuLCBUb2tlbiwgRmVlQW1vdW50XVtdID0gU1VQUE9SVEVEX1BPT0xTLm1hcCgocG9vbDogUG9vbCkgPT4ge1xuICAgICAgcmV0dXJuIFtwb29sLnRva2VuMCwgcG9vbC50b2tlbjEsIHBvb2wuZmVlXVxuICAgIH0pXG4gICAgY29uc3QgcHJvdmlkZXJDb25maWc6IFByb3ZpZGVyQ29uZmlnID0geyBibG9ja051bWJlcjogMTExIH1cbiAgICBhd2FpdCB0cmFmZmljU3dpdGNoUHJvdmlkZXIuZ2V0UG9vbHModG9rZW5QYWlycywgcHJvdmlkZXJDb25maWcpXG5cbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkKHNweSlcbiAgfSlcbn0pXG4iXX0=