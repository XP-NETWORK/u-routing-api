import { describe, expect, jest } from '@jest/globals';
import { ExtendedEther } from '@uniswap/smart-order-router';
import { ChainId, Token } from '@uniswap/sdk-core';
import { CurrencyLookup } from '../../../../lib/handlers/CurrencyLookup';
const address = '0x0000000000000000000000000000000000000001';
const token = new Token(ChainId.MAINNET, address, 18, 'FOO', 'Foo');
describe('CurrencyLookup', () => {
    it('Returns the native token if tokenRaw is a native token string', async () => {
        const tokenLookup = new CurrencyLookup({}, // tokenListProvider
        {}, // tokenProvider,
        {
            debug: jest.fn(),
        } // log
        );
        const result = await tokenLookup.searchForToken('ETH', ChainId.MAINNET);
        expect(result).toBeDefined();
        expect(result).toEqual(ExtendedEther.onChain(ChainId.MAINNET));
    });
    it('Finds the token in the token list when the input is an address', async () => {
        const tokenLookup = new CurrencyLookup({
            getTokenByAddress: (inputAddress) => (inputAddress === address ? token : undefined),
        }, // tokenListProvider
        {}, // tokenProvider,
        {
            debug: jest.fn(),
        } // log
        );
        const result = await tokenLookup.searchForToken(address, ChainId.MAINNET);
        expect(result).toBeDefined();
        expect(result).toEqual(token);
    });
    it('Finds the token in the token list when the input is a symbol', async () => {
        const tokenLookup = new CurrencyLookup({
            getTokenBySymbol: (inputSymbol) => (inputSymbol === 'FOO' ? token : undefined),
        }, // tokenListProvider
        {}, // tokenProvider,
        {
            debug: jest.fn(),
        } // log
        );
        const result = await tokenLookup.searchForToken('FOO', ChainId.MAINNET);
        expect(result).toBeDefined();
        expect(result).toEqual(token);
    });
    it('Returns the token if the on-chain lookup by address is successful', async () => {
        const tokenLookup = new CurrencyLookup({
            // Both token list lookups return null
            getTokenBySymbol: () => undefined,
            getTokenByAddress: () => undefined,
        }, // tokenListProvider
        {
            getTokens: () => {
                return {
                    getTokenByAddress: (inputAddress) => (inputAddress === address ? token : undefined),
                };
            },
        }, // tokenProvider,
        {
            debug: jest.fn(),
        } // log
        );
        const result = await tokenLookup.searchForToken(address, ChainId.MAINNET);
        // Because the input address was a symbol and not an address, expect the result to be undefined.
        expect(result).toBe(token);
    });
    it('Returns undefined if the on-chain lookup is by symbol', async () => {
        const tokenLookup = new CurrencyLookup({
            // Both token list lookups return null
            getTokenBySymbol: () => undefined,
            getTokenByAddress: () => undefined,
        }, // tokenListProvider
        {
            getTokens: () => {
                return {
                    getTokenByAddress: (inputAddress) => (inputAddress === address ? token : undefined),
                };
            },
        }, // tokenProvider,
        {
            debug: jest.fn(),
        } // log
        );
        const result = await tokenLookup.searchForToken('FOO', ChainId.MAINNET);
        // Because the input address was a symbol and not an address, expect the result to be undefined.
        expect(result).toBeUndefined();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3VycmVuY3lMb29rdXAudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Rlc3QvamVzdC91bml0L2hhbmRsZXJzL0N1cnJlbmN5TG9va3VwLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFBO0FBQ3RELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQTtBQUMzRCxPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLG1CQUFtQixDQUFBO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQTtBQUV4RSxNQUFNLE9BQU8sR0FBRyw0Q0FBNEMsQ0FBQTtBQUM1RCxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFBO0FBRW5FLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDOUIsRUFBRSxDQUFDLCtEQUErRCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzdFLE1BQU0sV0FBVyxHQUFHLElBQUksY0FBYyxDQUNwQyxFQUFTLEVBQUUsb0JBQW9CO1FBQy9CLEVBQVMsRUFBRSxpQkFBaUI7UUFDNUI7WUFDRSxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNWLENBQUMsTUFBTTtTQUNoQixDQUFBO1FBQ0QsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUE7UUFFdkUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO1FBQzVCLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLE9BQU8s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QkFBaUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxTQUFTO1NBQzVCLEVBQUUsb0JBQW9CO1FBQzlCO1lBQ0UsU0FBUyxFQUFFLEdBQUcsRUFBRTtnQkFDZCxPQUFPO29CQUNMLGlCQUFpQixFQUFFLENBQUMsWUFBb0IsRUFBRSxFQUFFLENBQUMsQ0FBQyxZQUFZLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztpQkFDNUYsQ0FBQTtZQUNILENBQUM7U0FDSyxFQUFFLGlCQUFpQjtRQUMzQjtZQUNFLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1NBQ1YsQ0FBQyxNQUFNO1NBQ2hCLENBQUE7UUFDRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFdBQVcsQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUV2RSxnR0FBZ0c7UUFDaEcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFBO0lBQ2hDLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgZXhwZWN0LCBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscydcbmltcG9ydCB7IEV4dGVuZGVkRXRoZXIgfSBmcm9tICdAdW5pc3dhcC9zbWFydC1vcmRlci1yb3V0ZXInXG5pbXBvcnQgeyBDaGFpbklkLCBUb2tlbiB9IGZyb20gJ0B1bmlzd2FwL3Nkay1jb3JlJ1xuaW1wb3J0IHsgQ3VycmVuY3lMb29rdXAgfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvaGFuZGxlcnMvQ3VycmVuY3lMb29rdXAnXG5cbmNvbnN0IGFkZHJlc3MgPSAnMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxJ1xuY29uc3QgdG9rZW4gPSBuZXcgVG9rZW4oQ2hhaW5JZC5NQUlOTkVULCBhZGRyZXNzLCAxOCwgJ0ZPTycsICdGb28nKVxuXG5kZXNjcmliZSgnQ3VycmVuY3lMb29rdXAnLCAoKSA9PiB7XG4gIGl0KCdSZXR1cm5zIHRoZSBuYXRpdmUgdG9rZW4gaWYgdG9rZW5SYXcgaXMgYSBuYXRpdmUgdG9rZW4gc3RyaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRva2VuTG9va3VwID0gbmV3IEN1cnJlbmN5TG9va3VwKFxuICAgICAge30gYXMgYW55LCAvLyB0b2tlbkxpc3RQcm92aWRlclxuICAgICAge30gYXMgYW55LCAvLyB0b2tlblByb3ZpZGVyLFxuICAgICAge1xuICAgICAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgICAgfSBhcyBhbnkgLy8gbG9nXG4gICAgKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRva2VuTG9va3VwLnNlYXJjaEZvclRva2VuKCdFVEgnLCBDaGFpbklkLk1BSU5ORVQpXG5cbiAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChFeHRlbmRlZEV0aGVyLm9uQ2hhaW4oQ2hhaW5JZC5NQUlOTkVUKSlcbiAgfSlcblxuICBpdCgnRmluZHMgdGhlIHRva2VuIGluIHRoZSB0b2tlbiBsaXN0IHdoZW4gdGhlIGlucHV0IGlzIGFuIGFkZHJlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdG9rZW5Mb29rdXAgPSBuZXcgQ3VycmVuY3lMb29rdXAoXG4gICAgICB7XG4gICAgICAgIGdldFRva2VuQnlBZGRyZXNzOiAoaW5wdXRBZGRyZXNzOiBzdHJpbmcpID0+IChpbnB1dEFkZHJlc3MgPT09IGFkZHJlc3MgPyB0b2tlbiA6IHVuZGVmaW5lZCksXG4gICAgICB9IGFzIGFueSwgLy8gdG9rZW5MaXN0UHJvdmlkZXJcbiAgICAgIHt9IGFzIGFueSwgLy8gdG9rZW5Qcm92aWRlcixcbiAgICAgIHtcbiAgICAgICAgZGVidWc6IGplc3QuZm4oKSxcbiAgICAgIH0gYXMgYW55IC8vIGxvZ1xuICAgIClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b2tlbkxvb2t1cC5zZWFyY2hGb3JUb2tlbihhZGRyZXNzLCBDaGFpbklkLk1BSU5ORVQpXG5cbiAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh0b2tlbilcbiAgfSlcblxuICBpdCgnRmluZHMgdGhlIHRva2VuIGluIHRoZSB0b2tlbiBsaXN0IHdoZW4gdGhlIGlucHV0IGlzIGEgc3ltYm9sJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRva2VuTG9va3VwID0gbmV3IEN1cnJlbmN5TG9va3VwKFxuICAgICAge1xuICAgICAgICBnZXRUb2tlbkJ5U3ltYm9sOiAoaW5wdXRTeW1ib2w6IHN0cmluZykgPT4gKGlucHV0U3ltYm9sID09PSAnRk9PJyA/IHRva2VuIDogdW5kZWZpbmVkKSxcbiAgICAgIH0gYXMgYW55LCAvLyB0b2tlbkxpc3RQcm92aWRlclxuICAgICAge30gYXMgYW55LCAvLyB0b2tlblByb3ZpZGVyLFxuICAgICAge1xuICAgICAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgICAgfSBhcyBhbnkgLy8gbG9nXG4gICAgKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRva2VuTG9va3VwLnNlYXJjaEZvclRva2VuKCdGT08nLCBDaGFpbklkLk1BSU5ORVQpXG5cbiAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh0b2tlbilcbiAgfSlcblxuICBpdCgnUmV0dXJucyB0aGUgdG9rZW4gaWYgdGhlIG9uLWNoYWluIGxvb2t1cCBieSBhZGRyZXNzIGlzIHN1Y2Nlc3NmdWwnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdG9rZW5Mb29rdXAgPSBuZXcgQ3VycmVuY3lMb29rdXAoXG4gICAgICB7XG4gICAgICAgIC8vIEJvdGggdG9rZW4gbGlzdCBsb29rdXBzIHJldHVybiBudWxsXG4gICAgICAgIGdldFRva2VuQnlTeW1ib2w6ICgpID0+IHVuZGVmaW5lZCxcbiAgICAgICAgZ2V0VG9rZW5CeUFkZHJlc3M6ICgpID0+IHVuZGVmaW5lZCxcbiAgICAgIH0gYXMgYW55LCAvLyB0b2tlbkxpc3RQcm92aWRlclxuICAgICAge1xuICAgICAgICBnZXRUb2tlbnM6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0VG9rZW5CeUFkZHJlc3M6IChpbnB1dEFkZHJlc3M6IHN0cmluZykgPT4gKGlucHV0QWRkcmVzcyA9PT0gYWRkcmVzcyA/IHRva2VuIDogdW5kZWZpbmVkKSxcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9IGFzIGFueSwgLy8gdG9rZW5Qcm92aWRlcixcbiAgICAgIHtcbiAgICAgICAgZGVidWc6IGplc3QuZm4oKSxcbiAgICAgIH0gYXMgYW55IC8vIGxvZ1xuICAgIClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b2tlbkxvb2t1cC5zZWFyY2hGb3JUb2tlbihhZGRyZXNzLCBDaGFpbklkLk1BSU5ORVQpXG5cbiAgICAvLyBCZWNhdXNlIHRoZSBpbnB1dCBhZGRyZXNzIHdhcyBhIHN5bWJvbCBhbmQgbm90IGFuIGFkZHJlc3MsIGV4cGVjdCB0aGUgcmVzdWx0IHRvIGJlIHVuZGVmaW5lZC5cbiAgICBleHBlY3QocmVzdWx0KS50b0JlKHRva2VuKVxuICB9KVxuXG4gIGl0KCdSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgb24tY2hhaW4gbG9va3VwIGlzIGJ5IHN5bWJvbCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0b2tlbkxvb2t1cCA9IG5ldyBDdXJyZW5jeUxvb2t1cChcbiAgICAgIHtcbiAgICAgICAgLy8gQm90aCB0b2tlbiBsaXN0IGxvb2t1cHMgcmV0dXJuIG51bGxcbiAgICAgICAgZ2V0VG9rZW5CeVN5bWJvbDogKCkgPT4gdW5kZWZpbmVkLFxuICAgICAgICBnZXRUb2tlbkJ5QWRkcmVzczogKCkgPT4gdW5kZWZpbmVkLFxuICAgICAgfSBhcyBhbnksIC8vIHRva2VuTGlzdFByb3ZpZGVyXG4gICAgICB7XG4gICAgICAgIGdldFRva2VuczogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRUb2tlbkJ5QWRkcmVzczogKGlucHV0QWRkcmVzczogc3RyaW5nKSA9PiAoaW5wdXRBZGRyZXNzID09PSBhZGRyZXNzID8gdG9rZW4gOiB1bmRlZmluZWQpLFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0gYXMgYW55LCAvLyB0b2tlblByb3ZpZGVyLFxuICAgICAge1xuICAgICAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgICAgfSBhcyBhbnkgLy8gbG9nXG4gICAgKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRva2VuTG9va3VwLnNlYXJjaEZvclRva2VuKCdGT08nLCBDaGFpbklkLk1BSU5ORVQpXG5cbiAgICAvLyBCZWNhdXNlIHRoZSBpbnB1dCBhZGRyZXNzIHdhcyBhIHN5bWJvbCBhbmQgbm90IGFuIGFkZHJlc3MsIGV4cGVjdCB0aGUgcmVzdWx0IHRvIGJlIHVuZGVmaW5lZC5cbiAgICBleHBlY3QocmVzdWx0KS50b0JlVW5kZWZpbmVkKClcbiAgfSlcbn0pXG4iXX0=